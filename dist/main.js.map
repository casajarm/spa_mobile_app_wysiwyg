{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/app/index.js","webpack:///./src/app/modules/channel.js","webpack:///./src/app/modules/clonechannel.js","webpack:///./src/app/modules/likemojis.js","webpack:///./src/app/modules/organizations.js","webpack:///./src/app/modules/styles.js","webpack:///./src/app/modules/users.js","webpack:///./src/app/modules/viewcontrol.js","webpack:///./src/app/views/catLeftView.js","webpack:///./src/app/views/categoriesEditor.js","webpack:///./src/app/views/categoryView.js","webpack:///./src/app/views/likemojisListView.js","webpack:///./src/app/views/loginForm.js","webpack:///./src/app/views/phoneView.js","webpack:///./src/app/views/signupForm.js","webpack:///./src/app/views/styleEditorView.js"],"names":["lighterhtml","render","html","svg","panel1","panel2","panel3","panelStyle","channelName","user","channelID","selectedCategoryID","panelCategories","panelLikemojis","panelEditor","panelStyleEditor","channels","editors","activeEditorWindow","imagefile","unsplashResults","parseFile","headerParseFile","ipadParseFile","emptySpan","mockObject","url","document","onreadystatechange","readyState","initApplication","page","getElementById","getOrCreateDiv","Parse","initialize","serverURL","User","start","hashbang","dispatch","base","ctx","next","viewControl","deleteAll","add","redirect","deleteView","signupUser2","querySelector","addEventListener","e","preventDefault","user_password","value","user_email","alert","isCurrent","targetOrg","Organization","set","save","then","org","console","log","targetOrgId","id","sourceOrgId","Channel","mainCategory","classList","imageSource","info","loginButton","$","val","loginParse","logOut","current","shareChannel","form","populateAll","params","orgID","selectedCategory","length","displayChannelList","categories","remove","inlineStyle","channelStyle","groupID","showRightLink","clearPanel","panel","panelContents","childNodes","i","holdingPen","appendChild","renderForm","formFunction","formArguments","_form","err","showform","formID","style","visible","display","selectChannel","targetChannel","currentTarget","dataset","route","orgList","map","attributes","name","username","password","logIn","get","styleSheet","styleTag","createElement","append","parent","elem","on","event","modal","triggeringElement","relatedTarget","reset","find","attr","text","categoryID","groupSelected","names","en","disable","prop","hide","newCategoryImage","fadeIn","_name","click","fileUploadControl","files","file","File","_url","error","categoryText","categoryNameInternal","categoryTextEN","Group","Object","extend","disabled","is","undefined","newHeader","group","addCategory","message","newIpadHeader","updateViews","thisLikemojiID","likemoji","likemojis","x","x3","likemojiNamesEN","returnedLikemoji","createLikemoji","slice","Likemoji","newLikemoji","catch","push","change","promiseChain","Promise","all","channel","styles","_selectedCategory","category","ID","popID","getOrgCategories","getLikemojis","resetStyle","fetch","catLikemojis","filter","moji","deleteCategory","channelGroups","ind","findIndex","splice","arrayToPointers","ind2","destroy","cat","addLikemoji","deleteLikemoji","rem","removeCategoryLikemoji","forEach","saveAll","addCategoryLikemoji","likemojiID","likemojiObj","maxCount","isMainCategory","catLikemojiIDs","setCategoryOrder","ids","orders","mainCat","subCategories","update","main","orgId","query","Query","equalTo","ascending","arr","pointerClass","pointers","__type","className","objectId","currentUser","cloneChannel","req","sourceOrg","getOrganization","header","callOut","groupIDs","_likemojis","likemojiIDs","cloneLikemojis","_likemojIDs","getGroups","groups","_groups","cloneGroups","_groupIDS","copyStyleToOrg","mojis","organization","mojiSaveArray","result","copyMojiToOrg","oldID","newID","resolvedmojiSaveArray","clone","setACL","getACL","cloneGroup","newGroup","remapIDs","groupSaveArray","resolvedgroupSaveArray","fromOrgID","toOrgID","ChannelStyle","newStyle","getStyle","_styles","sourceArray","mappingArray","mapp","lookup","findID","remappedIDs","newid","el","cloneMojies","cloneLikemojies","sortName","sortMojisByName","mojies","newLikemojisArray","intermediateLikemojisArray","copiedFromID","setNewGroupLikemojisArray","importedLikemojisIDs","newLikemojisArrayIDs","newGroupLikemojis","importedLikemojis","categoriesSorted","j","oldLikemojiIndex","indexOf","newGroupsLikemojis","sort","SortByName","a","b","aName","toLowerCase","bName","saveChannelToOrg","returnedOrg","groupsIDs","groupPointers","saveNewStyle","getUserChannels","userId","newUser","email","signUp","code","userLogin","logout","window","location","href","views","target","source","key","viewDef","deleted","renders","catLeftView","togglePanelWithin","panelName","parentName","children","warn","callCategoriesEditor","callCategoryEditor","callLikemojiEditor","categoriesEditorView","selectedItem","categoriesEditorViewHTML","handleDrag","index","handleDrop","handleDragStart","dataTransfer","setData","list","parentNode","clientX","y","clientY","swapItem","elementFromPoint","nextSibling","insertBefore","setNewGroupOrder","catOrder","querySelectorAll","thisID","order","categoryEditorView","callOuts","description","descriptions","saveCallToAction","callOutText","callOutsObject","saveExtendedInfo","extendedInfoText","extenedInfoObject","categoryEditorViewHTML","callStyleEditor","likemojisListView","dragMoji","mojiID","getData","dropEvent","split","dragover","dragenter","likemojiView","likemojiViewHTML","likemojisListViewHTML","loginForm","phone","phoneView","likemojisView","mainPageClass","mojiHtml","phoneHTML","categoriesSubView","phoneNavBarView","homeClick","phoneHome","navHTML","categoryView","skipMain","organizationID","selectCategory","targetID","imgSrc","catName","catID","categoryViewHTML","cats","getCategoryLikemojis","IDs","getLikemojisByID","containedIn","signUpForm","styleEditorView","jscolor","editorView","setTemp","closeStyleEditor","saveStyle","attribs","close","dirty","confirm"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/app/index.js\");\n","\"use strict\";\r\nimport {getUserChannels, newUser} from \"./modules/users.js\";\r\nimport cloneChannel from \"./modules/clonechannel.js\";\r\nimport {Organization} from \"./modules/organizations.js\";\r\nimport {Channel, viewControl} from './modules/channel.js';\r\nimport {phoneView} from './views/phoneView.js';\r\nimport categoryEditorView from './views/categoryView.js';\r\nimport categoriesEditorView from './views/categoriesEditor.js';\r\nimport catLeftView from './views/catLeftView.js';\r\nimport likemojisListView from './views/likemojisListView.js';\r\nimport styleEditorView from './views/styleEditorView.js';\r\nimport signUpForm from './views/signupForm.js';\r\nimport loginForm from './views/loginForm.js';\r\nconst {render, html, svg} = lighterhtml;// this is loaded in the index.html file\r\n\r\nvar panel1,\r\n    panel2,\r\n    panel3,\r\n    panelStyle,\r\n    channelName,\r\n    user,\r\n    channelID,              // currently selected channel ID\r\n    selectedCategoryID,     // currently selected category ID\r\n    panelCategories,\r\n    panelLikemojis,\r\n    panelEditor,\r\n    panelStyleEditor;             //styles editor\r\nvar channels = []           // list of users channels\r\n\r\n\r\n//modal editor vars\r\nvar editors = []; //users ids able to edit the channel to populate channel list\r\nvar activeEditorWindow = \"pageHeaderEditor\";\r\nvar imagefile; //image to be saved to S3\r\nvar unsplashResults = []; //array of images returned from unsplash search\r\nvar parseFile;\r\nvar headerParseFile;\r\nvar ipadParseFile;\r\n\r\nconst emptySpan = function() {\r\n    return html`<span />`;\r\n};\r\n\r\n// used to deal with errors on undefined attributes where parse wants you to chain a call to something like URL to the attribute\r\n// for example groupSelected.attributes.newCategoryImage.url()\r\nlet mockObject = {};\r\nmockObject.url = function () {\r\n    return '';\r\n};\r\n\r\nchannelName = \"You Beautiful Person You\";\r\ndocument.onreadystatechange = function () {\r\n    if (document.readyState === \"complete\") {\r\n        initApplication();\r\n        page(\"/\");\r\n    }\r\n};\r\n\r\nfunction initApplication() {\r\n    panel1 = document.getElementById(\"panel1\");\r\n    panel2 = document.getElementById(\"panel2\");\r\n    panel3 = document.getElementById(\"panel3\");\r\n    panelStyle = document.getElementById(\"panel-style\");\r\n    // not sure about having to add these elements like this\r\n    panelLikemojis = getOrCreateDiv('panel-likemojis', panel3);\r\n    panelEditor =  getOrCreateDiv('panel-editor', panel3)\r\n    panelCategories = getOrCreateDiv('panel-categories', panel3);\r\n    panelStyleEditor =  getOrCreateDiv('panel-style-editor', panel3);\r\n\r\n    Parse.initialize(\"fg8ZXCHKfBOWme42LGPA\");\r\n    Parse.serverURL = \"https://lmx-stage-alex.herokuapp.com/parse\";\r\n    user = new Parse.User();\r\n}\r\n\r\npage.start({hashbang: false, dispatch: true});\r\n//page.base(\"/src/app/page_router_example.html\");\r\npage.base('/src/app');\r\npage(\"/\", function (ctx, next) {\r\n    viewControl.deleteAll();\r\n    viewControl.add(panel1\r\n    , () => html`\r\n        <ul>\r\n            <li><a href=\"signup\">Create New Account</a></li>\r\n            <li><a href=\"login\">Login</a></li>\r\n        </ul>`);\r\n    viewControl.add(panel2, () => emptySpan());\r\n    viewControl.add(panel3, () => emptySpan());\r\n});\r\n\r\npage(\"/home\", function (ctx, next) {\r\n    page.redirect(\"/\");\r\n});\r\n\r\npage(\"/signup\", function (ctx, next) {\r\n    //panel 2\r\n    viewControl.deleteView(panel2);\r\n    viewControl.add(panel3, () => emptySpan());\r\n    viewControl.add(panel2, () => signUpForm());\r\n    //not sure if this is the best place to wire up event handlers...\r\n    let signupUser2 = document.querySelector(\"#signUpUser2\");\r\n    signupUser2.addEventListener(\"click\", async function (e) {\r\n        e.preventDefault();\r\n        // create the user\r\n        let user_password = document\r\n            .getElementById(\"inputPassword\")\r\n            .value;\r\n        let user_email = document\r\n            .getElementById(\"inputEmail\")\r\n            .value;\r\n        try {\r\n            user = await newUser(user_email, user_password)\r\n        } catch (e) {\r\n            alert('error: ' + e);\r\n            // TODO we could redirect to another route?\r\n        }\r\n\r\n        // TODO we need to put validation controls around the signup form\r\n        if (user.isCurrent()) {\r\n            // set orgname/channelname in state\r\n            channelName = document\r\n                .getElementById(\"inputOrganization\")\r\n                .value;\r\n\r\n            // TODO see if we can just give it a route for clone and then a \"next\" clone a\r\n            // channel for them start by cloning channel xGO7Pdu71w\r\n            const targetOrg = new Organization();\r\n            const channelID = \"xGO7Pdu71w\"; //TODO make this dynamic based on how they enter\r\n            //TODO if the name is not unique???\r\n            targetOrg.set(\"name\", channelName);\r\n            targetOrg\r\n                .save()\r\n                .then(async function (org) {\r\n                    console.log(\"New org saved .. now clone\");\r\n                    await cloneChannel({targetOrgId: org.id, sourceOrgId: channelID});\r\n                    //TODO update header image with fabric built image\r\n                    Channel.mainCategory().set('headerimage', '')\r\n\r\n                    document.getElementById('login').classList.add('active');\r\n                    page(`/viewnew/${org.id}`);\r\n                    }\r\n                );\r\n        }\r\n    });\r\n\r\n    let imageSource = \"../assets/screenshots/IMG_0971.png\";\r\n    viewControl.add(panel3, () => html`<img src=\"${imageSource}\" />`);\r\n});\r\n\r\n\r\npage(\"/login\", function (ctx, next) {\r\n    console.info('login route');\r\n    viewControl.deleteAll();\r\n    viewControl.add(panel2, () => loginForm());\r\n\r\n    //not sure if this is the best place to wire up event handlers...\r\n    let loginButton = document.querySelector(\"#loginUser\");\r\n    loginButton.addEventListener(\"click\", function (e) {\r\n        e.preventDefault();\r\n        // login the user\r\n        var user_password = $(\"#loginPassword\").val();\r\n        var user_email = $(\"#loginEmail\").val();\r\n        // then show them the page listing their channels\r\n        console.log(`responding to the click event ${e}`);\r\n        loginParse(user_email, user_password).then(function () {\r\n            //hide login link\r\n            document.getElementById('login').classList.add('active');\r\n            // move along\r\n            page(\"/channels\");\r\n        });\r\n    });\r\n}); // login page\r\n\r\npage(\"/logout\", function (ctx, next) {\r\n    viewControl.deleteAll();\r\n    Parse.User.logOut().then(() => {\r\n        console.info('user logged out');\r\n        user = Parse.User.current();\r\n        page.redirect('/home');\r\n        });\r\n    }\r\n); // logout\r\n\r\n\r\npage(\"/distribute\", function (ctx, next) {\r\n    viewControl.add(panel1, () => html`<h1>About your Likemoji Channel</h1>`);\r\n    viewControl.add(panel3, () => {\r\n        function shareChannel(e) {\r\n            e.preventDefault();\r\n            alert(\"emails are on the way\");\r\n        }\r\n\r\n        let form = html`<h2>A list of links for channel</h2>\r\n        <ul>\r\n            <li>Link1</li>\r\n            <li>Link2</li>\r\n            <li>Link3</li>\r\n        </ul>\r\n        <form>\r\n            <textarea id=\"email-list\" placeholder=\"enter emails to share your channel\">\r\n            </textarea>\r\n            <button id=\"share-channel-button\"\r\n                class=\"btn btn-default\"\r\n                onclick=\"${shareChannel}\"\r\n            >Share Channel\r\n            </button>\r\n        </form>`;\r\n        return form;\r\n        }\r\n    );\r\n\r\n}); // distribute page\r\n\r\npage(\"/viewnew/:orgID\", async function (ctx, next) {\r\n    await Channel.populateAll(ctx.params.orgID);\r\n    viewControl.add(panel1, () => html`<h1>About your Likemoji Channel</h1>`);\r\n    //showLink(ctx, next, boilerplate);\r\n    Channel.selectedCategory = Channel.mainCategory;\r\n    viewControl.add(panel2, () => phoneView(Channel));\r\n\r\n    viewControl.add(panel3, () => {\r\n        let form = html`<h2>Congratulations ${Channel.channelName}!</h2>\r\n        <h3>Here's your new Likemoji channel</h3>\r\n        <button id=\"next-step-button\"\r\n            onclick=\"${() => page('/distribute')}\"\r\n            class=\"btn btn-default\">Next</button>`;\r\n        return form;\r\n    });\r\n\r\n}); // viewnew/orgID page\r\n\r\npage(\"/channels\", async function (ctx, next) {\r\n    console.log(\"channel list view\");\r\n    if (user.isCurrent()) {\r\n    channels = await getUserChannels(user.id)\r\n    console.log(`getUserChannels returned count: ${channels.length}`);\r\n\r\n\r\n    viewControl.add(panel1, () => displayChannelList(channels));\r\n    viewControl.deleteView(panel2);\r\n    viewControl.deleteView(panel3);\r\n\r\n}\r\n\r\n}); //channels page\r\n\r\npage(\"/channel/:channelID/clone\", function (ctx, next) {\r\n    channelID = ctx.params.channelID;\r\n    console.log(`entering clone for channel id ${channelID}`);\r\n    channelName = \"Clone of \" + channelID;\r\n    const targetOrg = new Organization();\r\n    targetOrg.set(\"name\", channelName);\r\n    targetOrg\r\n        .save()\r\n        .then(async function (org) {\r\n            console.log(\"New org saved .. now clone\");\r\n            await cloneChannel({targetOrgId: org.id, sourceOrgId: channelID});\r\n            //redirect to the view now\r\n            page.redirect(`/viewnew/${org.id}`);\r\n        });\r\n});\r\n\r\npage(\"/channel/:channelID/view\",  async function (ctx, next) {\r\n    channelID = ctx.params.channelID;\r\n    console.log(`entering view for channel id ${channelID}`);\r\n    if (!Channel.channelID\r\n        || Channel.channelID != channelID) {\r\n            await Channel.populateAll(channelID);\r\n            //channel = channels.find(x => x.id === channelID);\r\n    }\r\n    Channel.selectedCategory = Channel.mainCategory;\r\n    viewControl.deleteAll();\r\n    viewControl.add(panel2, () => phoneView(Channel));\r\n    viewControl.add(panel1, () => catLeftView(Channel.categories));\r\n    // not sure about having to add these elements like this\r\n    panelLikemojis = getOrCreateDiv('panel-likemojis', panel3);\r\n    panelEditor =  getOrCreateDiv('panel-editor', panel3)\r\n    panelCategories = getOrCreateDiv('panel-categories', panel3);\r\n    panelStyleEditor =  getOrCreateDiv('panel-style-editor', panel3);\r\n\r\n    panelLikemojis.classList.add('hidden');\r\n    panelCategories.classList.add('hidden');\r\n    panelStyleEditor.classList.add('hidden');\r\n    panelEditor.classList.remove('hidden');\r\n\r\n    // we could combine these 4 views into one view.js file\r\n    viewControl.add(panelCategories, () => categoriesEditorView(Channel));\r\n    viewControl.add(panelEditor, () => categoryEditorView(Channel));\r\n    viewControl.add(panelLikemojis, () => likemojisListView(Channel));\r\n    viewControl.add(panelStyleEditor, () => styleEditorView(Channel));\r\n\r\n    viewControl.add(panelStyle, () => inlineStyle(Channel.channelStyle));\r\n\r\n});  //channel view\r\n\r\npage(\"/channel/:channelID/view/:groupID\", async function (ctx, next) {\r\n    if (!Channel.channelID\r\n        || Channel.channelID != ctx.params.channelID) {\r\n        channelID = ctx.params.channelID;\r\n        Channel.populateAll(channelID);\r\n        //channel = channels.find(x => x.id === channelID);\r\n        }\r\n\r\n        selectedCategoryID = ctx.params.groupID;\r\n        console.log(`entering view for channel id ${channelID} and group ${selectedCategoryID}`);\r\n        Channel.selectedCategoryID = selectedCategoryID;\r\n        viewControl.add(panel2, () => phoneView(Channel));\r\n\r\n        viewControl.add(panelCategories, () => categoriesEditorView(Channel));\r\n        viewControl.add(panelEditor, () => categoryEditorView(Channel));\r\n        viewControl.add(panelLikemojis, () => likemojisListView(Channel));\r\n        viewControl.add(panelStyleEditor, () => styleEditorView(Channel));\r\n\r\n        viewControl.add(panelStyle, () => inlineStyle(Channel.channelStyle));\r\n        // TODO add the back button on the left panel\r\n        panelLikemojis.classList.add('hidden');\r\n        panelCategories.classList.add('hidden');\r\n        panelStyleEditor.classList.add('hidden');\r\n        panelEditor.classList.remove('hidden');\r\n\r\n});//channel group page\r\n\r\n\r\npage(\"/channel/:channelID/edit\", function (ctx, next) {\r\n    console.log(`entering edit for channel id ${ctx.channelID}`);\r\n}); //channel editor page\r\n\r\n\r\n\r\npage(\"/right/link10\", function (ctx, next) {\r\n    console.log(\"link10\");\r\n    showRightLink(ctx, next, \"link10\");\r\n});\r\n\r\npage(\"*\", function (ctx, next) {\r\n    console.log(\"catch all route\");\r\n    console.log(ctx);\r\n});\r\n\r\n\r\n\r\nfunction clearPanel(panel) {\r\n    var panelContents = panel.childNodes;\r\n    for (i = 0; i < panelContents.length; i++) {\r\n        holdingPen.appendChild(panelContents[i]);\r\n    }\r\n}\r\n\r\nfunction renderForm(panel, formFunction, formArguments) {\r\n    let form;\r\n    // sometimes form is a promise\r\n    // try to resolve and if it is not a thennable just append the result\r\n    //\r\n    try {\r\n         formFunction(formArguments).then(_form => {panel.appendChild(_form)});\r\n    }\r\n    catch (err) {\r\n        form = formFunction(formArguments);\r\n        panel.appendChild(form);\r\n    }\r\n}\r\n\r\nfunction showform(formID, panel) {\r\n    var form = document.getElementById(formID);\r\n    form.style.visible = true;\r\n    form.style.display = \"block\";\r\n    panel.appendChild(form);\r\n}\r\n\r\n\r\n\r\n//<a href=\"channel/${i.id}/clone\">${i.attributes.name}</a>\r\nconst displayChannelList = (channels) => {\r\n    /* simple pattern for click handlers\r\n    define a function that takes (e) as parameter\r\n    --- function myClicker(e) {\r\n    inside function find the target and the id data attribute\r\n    --- let targetID = e.currentTarget.dataset.i;\r\n    --- execute something\r\n    then define onclick and data-i attribute\r\n    --- <a data-i=${i.id} onclick=\"${myClicker}\">\r\n    */\r\n\r\n    function selectChannel(e) {\r\n        let targetChannel = e.currentTarget.dataset.i;\r\n        let route = '/channel/' + targetChannel + '/view';\r\n        page(route);\r\n    }\r\n\r\n    let orgList = channels.map(i =>\r\n            html`<li class=\"channelList\" id=\"${i.id}\">\r\n                    <a data-i=${i.id} onclick=\"${selectChannel}\">${i.attributes.name}</a>\r\n                </li>`);\r\n\r\n    let form = html`<div>\r\n        <ul>\r\n            ${orgList}\r\n        </ul>\r\n    </div>`;\r\n    return form;\r\n}\r\n\r\nasync function loginParse(username, password) {\r\n    console.log(`logIn call with user: ${username} and pwd: ${password}`);\r\n    try {\r\n        user = await Parse\r\n            .User\r\n            .logIn(username, password);\r\n        console.log(\"logged in\");\r\n        return user;\r\n    } catch (err) {\r\n        console.log(`error logging in ${err}`);\r\n    }\r\n    /*\r\n        .then(function (newUser) {\r\n\t\t\tuser = newUser;\r\n\t\t\tif (user.isCurrent()) {\r\n\t\t\t\tconsole.log(\"loggedin\");\r\n\t\t\t} else {\r\n\t\t\t\tconsole.log(\"loggedout\");\r\n            }\r\n            return user;\r\n        })\r\n        .then(function (user) {\r\n            console.log('login function returning');\r\n            return user;\r\n        })\r\n        .catch(err => alert(err));\r\n   */\r\n}\r\n\r\nfunction inlineStyle(style) {\r\n    console.info(`running inline style with tabbar value of ${style.get(\"tabBar\")}`);\r\n    let styleSheet = `\r\n        #phoneDisplay {\r\n            background-color: ${style.get(\"generalColor\")};\r\n        }\r\n\r\n        .navBar {\r\n            background-color:  ${style.get(\"tabBar\")}\r\n        }\r\n\r\n        .activeNavIcon {\r\n            color:  ${style.get(\"tabBarSelected\")}\r\n        }\r\n\r\n        .channelText {\r\n            color:  ${style.get(\"generalTextColor\")}\r\n        }\r\n        .categorytxt {\r\n            color:  ${style.get(\"categoryTextColor\")}\r\n        }`;\r\n    let styleTag = document.createElement('style');\r\n    styleTag.append(styleSheet);\r\n    return styleTag;\r\n}\r\n\r\nfunction getOrCreateDiv(id, parent) {\r\n    let elem = document.getElementById(id);\r\n    if (!elem) {\r\n        elem = document.createElement('div')\r\n        elem.id = id;\r\n        parent.appendChild(elem);\r\n    }\r\n    return elem;\r\n}\r\n\r\n/* jquery/bootstrap handler for the categories editor modal\r\nTODO replace with template function?\r\n*/\r\n$('#addCategoriesModal').on('show.bs.modal',\r\n    function (event) {\r\n        let modal = $(this);\r\n        let triggeringElement = event.relatedTarget; // Button/link/div that triggered the modal\r\n        if (triggeringElement.id == 'addNewCategories') {\r\n            Channel.selectedCategory = null;\r\n            document.getElementById('likemoji-edit-form').reset();\r\n            modal.find(\"#categoryPreview\").attr(\"src\", '');\r\n            modal.find(\"#categoryImageName\").text('');\r\n        }\r\n        else {\r\n            let categoryID = triggeringElement.dataset.i; // Extract info from data-* attributes\r\n            Channel.selectedCategoryID = categoryID;\r\n            let groupSelected = Channel.selectedCategory;\r\n            modal.find(\"#categoryName\").val(groupSelected.attributes.name);\r\n            modal.find(\"#categoryDisplayName\").val(groupSelected.attributes.names.en);\r\n            modal.find(\"#categoryImageInput\").val(\"\");\r\n            if (groupSelected.attributes.disable == 1) {\r\n                modal.find(\"#disableCat\").prop(\"checked\", true);\r\n            } else {\r\n                modal.find(\"#disableCat\").prop(\"checked\", false);\r\n            }\r\n            modal.find(\"#categoryPreview\").hide();\r\n            modal.find(\"#categoryPreview\").attr(\"src\", (groupSelected.attributes.newCategoryImage || mockObject).url() || '');\r\n            modal.find(\"#categoryPreview\").fadeIn(650);\r\n            modal.find(\"#categoryImageName\").text((groupSelected.attributes.newCategoryImage || mockObject)._name);\r\n        }\r\n    }\r\n)\r\n\r\n//uploads a category image from category editor modal\r\n$(\"#categoryImageButton\").click(function() {\r\n\tlet fileUploadControl = $(\"#categoryImageInput\")[0];\r\n\tif (fileUploadControl.files.length > 0) {\r\n\t\tvar file = fileUploadControl.files[0];\r\n\t\tvar name = fileUploadControl.files[0].name;\r\n\t\tparseFile = new Parse.File(name, file);\r\n\r\n\t\tparseFile.save().then(\r\n\t\t\tfunction() {\r\n\t\t\t\t// $('#categoryPreview').hide();\r\n\t\t\t\t$(\"#categoryPreview\").attr(\"src\", parseFile._url);\r\n\t\t\t\t// $('#categoryPreview').fadeIn(650);\r\n\t\t\t\tconsole.log(parseFile._url);\r\n\r\n\t\t\t\t// The file has been saved to Parse.\r\n\t\t\t},\r\n\t\t\tfunction(error) {\r\n\t\t\t\t// The file either could not be read, or could not be saved to Parse.\r\n\t\t\t}\r\n\t\t);\r\n\t\t$(\"#categoryImageInput\")[0].value = \"\";\r\n\t}\r\n});\r\n\r\n//saves category when editor modal is closed with save button\r\n$(\"#saveCategory\").click(function(event) {\r\n    let categoryText = $(\"#categoryDisplayName\").val();\r\n\tlet categoryNameInternal = $(\"#categoryName\").val();\r\n\tlet categoryTextEN = {\r\n\t\ten: categoryText\r\n\t};\r\n    let Group = Parse.Object.extend('Group');\r\n    let disabled = $(\"#disableCat\").is(\":checked\") ? 1 : 0;\r\n    let groupSelected = Channel.selectedCategory;\r\n\r\n\tif (groupSelected == undefined) {\r\n\t\tgroupSelected = new Group(); //Parse.Object.createWithoutData('Group');\r\n\t\tgroupSelected.set(\"organizationID\", Channel.channelID);\r\n\t\tgroupSelected.set(\"order\", Channel.categories.length + 1);\r\n\t\tgroupSelected.set(\"newHeader\", Channel.mainCategory.attributes.newHeader);\r\n\t\tgroupSelected.set(\"callOuts\", { en: \"Connect with us!\" });\r\n\t\tgroupSelected.set(\"likemojis\", []);\r\n\t}\r\n\r\n\tgroupSelected.set(\"name\", categoryNameInternal);\r\n\tgroupSelected.set(\"names\", categoryTextEN);\r\n\tgroupSelected.set(\"disable\", disabled);\r\n\r\n\tif (parseFile != undefined) {\r\n\t\tgroupSelected.set(\"newCategoryImage\", parseFile);\r\n\t\tconsole.log(\"skipped\");\r\n\t}\r\n\r\n\t// need to add \"else\" above to handle if user adds a category and doesn't upload\r\n\t// an image.. should default to a default parse image we host - should do the\r\n\t// same for the header as well - currently it just duplicates the main page\r\n\t// header here...\r\n\r\n\tgroupSelected.save().then(\r\n\t\tasync group => {\r\n            Channel.addCategory(groupSelected)\r\n            .then( () => {\r\n                console.log(\"category saved\");\r\n                parseFile = undefined;\r\n                page.redirect('/channel/' + channelID + '/view/' + groupSelected.id);\r\n                //document.getElementById(\"categoriesInEditor\").innerHTML = \"\";\r\n            })\r\n\t\t},\r\n\t\terror => {\r\n\t\t\t//  error is a Parse.Error with an error code and message.\r\n\t\t\talert(\"Failed to create new object, with error code: \" + error.message);\r\n\t\t}\r\n\t);\r\n});\r\n\r\n//fills data for header editor modal\r\n$('#editheaderModal').on('show.bs.modal',\r\n    function (event) {\r\n        let modal = $(this);\r\n        let groupSelected = Channel.selectedCategory;\r\n\r\n        modal.find(\"#imageUpload\").val(\"\");\r\n        modal.find(\"#headerPreview\").attr(\"src\", groupSelected.attributes.newHeader.url());\r\n        modal.find(\"#headerEditorImageName\").text(groupSelected.attributes.newHeader._name);\r\n        modal.find(\"#ipadImageUpload\").val(\"\");\r\n        modal.find(\"#ipadHeaderPreview\").attr(\r\n            \"src\",\r\n            (groupSelected.attributes.newIpadHeader || mockObject).url() || ''\r\n        );\r\n        modal.find(\"#ipadHeaderEditorImageName\").text(\r\n            (groupSelected.attributes.newIpadHeader || mockObject)._name || ''\r\n    \t);\r\n    }\r\n);\r\n\r\n$(\"#saveEditedHeader\").click(function() {\r\n\t// var name = $('#imageUpload')[0].files[0].name;   $(\"#headerName\").text(name);\r\n    let groupSelected = Channel.selectedCategory;\r\n    groupSelected.set(\"newHeader\", headerParseFile);\r\n\tgroupSelected.set(\"newIpadHeader\", ipadParseFile);\r\n\tgroupSelected.save().then(\r\n\t\tgroup => {\r\n\t\t\t// Execute any logic that should take place after the object is saved.\r\n\t\t\tconsole.log(\"header saved\");\r\n            /*\r\n            $(\"#buildHeader img\").attr(\r\n\t\t\t\t\"src\",\r\n\t\t\t\tgroupSelected.attributes.newHeader.url()\r\n\t\t\t);\r\n\t\t\t$(\"#buildHeader\").hide();\r\n\t\t\t$(\"#buildHeader\").fadeIn(650);\r\n            */\r\n            Channel.updateViews();\r\n\r\n           // todo see if bootstrap has a reset modal feature\r\n            $(\"#imageUpload\")[0].value = \"\";\r\n\t\t},\r\n\t\terror => {\r\n\t\t\t// Execute any logic that should take place if the save fails. error is a\r\n\t\t\t// Parse.Error with an error code and message.\r\n\t\t\talert(\"Failed to create new object, with error code: \" + error.message);\r\n\t\t}\r\n\t);\r\n});\r\n\r\n// uploads mobile header image to parse and sets the preview image src\r\n$(\"#headerEditorImageButton\").click(function() {\r\n\tlet fileUploadControl = $(\"#imageUpload\")[0];\r\n\tif (fileUploadControl.files.length > 0) {\r\n\t\tlet file = fileUploadControl.files[0];\r\n\t\tlet name = fileUploadControl.files[0].name;\r\n\t\theaderParseFile = new Parse.File(name, file);\r\n\r\n\t\theaderParseFile.save().then(\r\n\t\t\tfunction() {\r\n\t\t\t\t$(\"#headerPreview\").attr(\"src\", headerParseFile._url);\r\n\r\n\t\t\t\tconsole.log(headerParseFile._url);\r\n\r\n\t\t\t\t// The file has been saved to Parse.\r\n\t\t\t},\r\n\t\t\tfunction(error) {\r\n\t\t\t\t// The file either could not be read, or could not be saved to Parse.\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n});\r\n\r\n// uploads mobile header image to parse and sets the preview image src\r\n\r\n$(\"#ipadHeaderEditorImageButton\").click(function() {\r\n\tconsole.log(\"ipad upload clicked\");\r\n\r\n\tlet fileUploadControl = $(\"#ipadImageUpload\")[0];\r\n\tif (fileUploadControl.files.length > 0) {\r\n\t\tlet file = fileUploadControl.files[0];\r\n\t\tlet name = fileUploadControl.files[0].name;\r\n\t\tipadParseFile = new Parse.File(name, file);\r\n\r\n\t\tipadParseFile.save().then(\r\n\t\t\tfunction() {\r\n\t\t\t\t$(\"#ipadHeaderPreview\").attr(\"src\", ipadParseFile._url);\r\n\r\n\t\t\t\tconsole.log(ipadParseFile._url);\r\n\r\n\t\t\t\t// The file has been saved to Parse.\r\n\t\t\t},\r\n\t\t\tfunction(error) {\r\n\t\t\t\t// The file either could not be read, or could not be saved to Parse.\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n});\r\n\r\n\r\n// when likemoji editor modal is opened this fills data\r\n$('#editLikemojisModal').on('show.bs.modal',\r\n    function (event) {\r\n        let thisLikemojiID = event.relatedTarget.id // id of calling likemoji icon\r\n        let modal = $(this);\r\n        // alert(\"clicked\");\r\n        let likemoji = Channel.likemojis.find(x => x.id === thisLikemojiID);\r\n\r\n        modal.find(\"#likemojiName\").val(likemoji.attributes.names.en);\r\n        modal.find(\"#likemojiEditorImageInput\").val(\"\");\r\n        modal.find(\"#likemojiPreview\").hide();\r\n        modal.find(\"#likemojiPreview\").attr(\"src\", likemoji.attributes.x3.url());\r\n        modal.find(\"#likemojiPreview\").fadeIn(650);\r\n        modal.find(\"#LikemojiEditorImageName\").text(likemoji.attributes.x3._name);\r\n        modal.find(\"#likemojiEditorImageButton\").click(function() {\r\n        let fileUploadControl = $(\"#likemojiEditorImageInput\")[0];\r\n        if (fileUploadControl.files.length > 0) {\r\n            let file = fileUploadControl.files[0];\r\n            let name = fileUploadControl.files[0].name;\r\n            parseFile = new Parse.File(name, file);\r\n\r\n            parseFile.save().then(\r\n                function() {\r\n                    // $('#likemojiPreview').hide();\r\n                    $(\"#likemojiPreview\").attr(\"src\", parseFile._url);\r\n                    // $('#likemojiPreview').fadeIn(650);\r\n                    console.log(parseFile._url);\r\n\r\n                    // The file has been saved to Parse.\r\n                },\r\n                function(error) {\r\n                    // The file either could not be read, or could not be saved to Parse.\r\n                }\r\n            );\r\n            $(\"#likemojiEditorImageInput\")[0].value = \"\";\r\n        }\r\n    });\r\n\r\n    //saves edited likemoji when editor modal is closed with save button\r\n    modal.find(\"#saveEditedLikemoji\").click(function(event) {\r\n            var likemojiNamesEN = $(\"#likemojiName\").val();\r\n\r\n            likemoji.set(\"names\", { en: likemojiNamesEN });\r\n\r\n            if (parseFile != undefined) {\r\n                likemoji.set(\"x3\", parseFile);\r\n            }\r\n\r\n            likemoji.save().then(\r\n                async returnedLikemoji => {\r\n                    // Execute any logic that should take place after the object is saved.\r\n                    console.log(\"likemoji saved\");\r\n                    Channel.updateViews();\r\n                    parseFile = undefined;\r\n                },\r\n                error => {\r\n                    // Execute any logic that should take place if the save fails. error is a\r\n                    // Parse.Error with an error code and message.\r\n                    alert(\"Failed to create new object, with error code: \" + error.message);\r\n                }\r\n            );\r\n    });\r\n});\r\n\r\n\r\n//creates a new likemoji from file uploader\r\nasync function createLikemoji(file) {\r\n    let name = file.name;\r\n\tlet parseFile = new Parse.File(name, file);\r\n\tlet likemojiNamesEN = name.slice(0, -4);\r\n    let Likemoji = Parse.Object.extend('Likemoji');\r\n    console.info('saving file named ' + name);\r\n    await parseFile.save()\r\n    let newLikemoji = new Likemoji();\r\n    console.info(`file ${name} saved now add likemojis`);\r\n    newLikemoji.set(\"x3\", parseFile);\r\n    newLikemoji.set(\"name\", name.slice(0, -4));\r\n    newLikemoji.set(\"names\", { en: likemojiNamesEN });\r\n    newLikemoji.set(\"organizationID\", Channel.channelID);\r\n    newLikemoji.set(\"organizationName\", Channel.channelName);\r\n    await newLikemoji.save()\r\n    .catch(error => {\r\n        // error is a Parse.Error with an error code and message.\r\n        alert(\"Failed to create new object, with error code: \" + error.message);\r\n    });\r\n    console.info(`likemoji ${name} saved now add to channel`);\r\n    Channel.likemojis.push(newLikemoji);\r\n    $(\"#uploadComplete\").fadeIn(1650);\r\n    // The file has been saved to Parse.\r\n    return newLikemoji;\r\n}\r\n\r\n$(\"#addLikemojisModalButton\").change(function() {\r\n\t$(\"#uploadComplete\").hide();\r\n});\r\n\r\n$(\"#likemojisImageButton\").click(async function() {\r\n\tlet fileUploadControl = document.getElementById(\"likemojisImageInput\").files;\r\n\tif (fileUploadControl.length > 0) {\r\n        let promiseChain = [];\r\n        for (var i = 0; i < fileUploadControl.length; i++) {\r\n            console.info('adding upload promise for file number' + i);\r\n            promiseChain.push (createLikemoji(fileUploadControl[i]));\r\n        }\r\n        await Promise.all(promiseChain)\r\n            .then( () =>  {\r\n                console.info('likemojis saved..now refresh views');\r\n                Channel.updateViews();\r\n                $(\"#likemojisImageInput\")[0].value = \"\";\r\n            });\r\n\t}\r\n});","import {Organization, getOrganization} from \"./organizations.js\";\r\nimport Likemoji from './likemojis.js';\r\nimport {ChannelStyle, saveNewStyle, getStyle} from \"./styles.js\";\r\nimport viewControl from './viewcontrol.js';\r\n\r\n//import {Group, getMainCategory} from \"./groups.js\";\r\n\r\nvar org = Parse.Object.extend(\"Organization\");\r\nconst Channel =  {\r\n    channel:    new org(),\r\n    categories: [], //Object.create(Group)]\r\n    likemojis:  [], //[Object.create(Likemoji)],\r\n    //TODO how to define function getCategoryLikemojis on each array element\r\n    styles:     [],// [Object.create(ChannelStyle)],\r\n    _selectedCategory: '',\r\n\r\n    get channelID() {return this.channel.id},\r\n\r\n    get selectedCategory() {return this._selectedCategory},\r\n    /**\r\n     * @param {object} category\r\n     */\r\n    set selectedCategory(category) {\r\n        this._selectedCategory = category;\r\n    },\r\n    get selectedCategoryID() {return this._selectedCategory.id},\r\n    set selectedCategoryID(ID) {\r\n        this._selectedCategory = this.categories.find(x => x.id === ID);\r\n    },\r\n\r\n    async populateAll(popID) {\r\n      // setting a new channel refresh all the related data\r\n        this.channel    = await getOrganization(popID);\r\n        this.categories = await getOrgCategories(popID);\r\n        this.likemojis  = await getLikemojis(popID);\r\n        this.styles     = await getStyle(popID);\r\n        console.log(`populated channel for ${popID}`);\r\n        console.log(`populated likemojis with ${this.likemojis.length}`);\r\n    },\r\n\r\n    async resetStyle() {\r\n        await this.styles[0].fetch()\r\n        console.info(`populated style and now tabbar has a value of ${Channel.channelStyle.get(\"tabBar\")}`);\r\n        return this.styles[0];\r\n    },\r\n\r\n    catLikemojis: function(category) {\r\n        let catLikemojis = category.get('likemojis');\r\n        // return the likemojis that match array in category\r\n        return this.likemojis.filter((moji) => catLikemojis.find(x => x === moji.id));\r\n    },\r\n\r\n    deleteCategory: async function(category) {\r\n        // remove from the channel object..group and grouppointers attributes\r\n        let channelGroups = this.channel.get('groups');\r\n        let ind = channelGroups.findIndex(x => x === category.id);\r\n        channelGroups.splice(ind,1);\r\n        this.channel.set('groups', channelGroups);\r\n        this.channel.set(\"groupPointer\", arrayToPointers(channelGroups, \"Group\"));\r\n        //and remove it from this local object\r\n        let ind2 = this.categories.findIndex(x => x.id === category.id);\r\n        this.categories.splice(ind2, 1);\r\n        await this.channel.save();\r\n\r\n        //search parse to see if category has connected data\r\n        // if not then delete it\r\n\r\n        category.save();\r\n        // destroy means delete...\r\n        await category.destroy().then((cat) => {\r\n            // The object was deleted from the Parse Cloud.\r\n        }, (error) => {\r\n            // The delete failed.\r\n            // error is a Parse.Error with an error code and message.\r\n            // TODO messaging function for unified handling of errors\r\n            }\r\n        );\r\n\r\n    },\r\n    addCategory: async function (category) {\r\n        // test if this is already in the channel\r\n        let ind = this.categories.findIndex(x => x.id === category.id);\r\n        if (ind < 0) {\r\n            this.categories.push(category);\r\n            //add to the channel object too\r\n            let channelGroups = this.channel.get('groups');\r\n            channelGroups.push(category.id);\r\n            this.channel.set('groups', channelGroups);\r\n            this.channel.set(\"groupPointer\", arrayToPointers(channelGroups, \"Group\"));\r\n            this.channel.save();\r\n            category.set('organizationID', this.channel.id);\r\n            category.set('organizationName', this.channel.get('name'));\r\n            await category.save();\r\n        }\r\n        return category;\r\n    },\r\n\r\n    addLikemoji: async function(likemoji) {\r\n        likemoji.set(\"Organization\", this.channel.id);\r\n        await likemoji.save();\r\n        this.likemojis.push(likemoji);\r\n    },\r\n    deleteLikemoji: async function(likemoji) {\r\n        // remove from group(s)\r\n        let rem = this.removeCategoryLikemoji;\r\n//        let {removeCategoryLikemoji: rem} = this;\r\n\r\n        this.categories.forEach(function(cat) {\r\n            rem(cat, likemoji);\r\n            }\r\n        )\r\n        // find the exact likemoji in our collection\r\n        let ind = this.likemojis.findIndex(x => x.id === likemoji.id);\r\n        this.likemojis.splice(ind, 1);\r\n        await Parse.Object.saveAll(this.categories);\r\n        await likemoji.destroy().then((moji) => {\r\n            // The object was deleted from the Parse Cloud.\r\n        }, (error) => {\r\n            // The delete failed.\r\n            // error is a Parse.Error with an error code and message.\r\n            // TODO messaging function for unified handling of errors\r\n            }\r\n        );\r\n    },\r\n    addCategoryLikemoji: async function(category, likemoji) {\r\n        //if likemoji is an id find the actual object\r\n        let likemojiID, likemojiObj, maxCount = 20;\r\n        if (typeof(likemoji) === \"string\" || typeof(likemoji) === \"number\") {\r\n            likemojiID = likemoji;\r\n            try {\r\n                likemojiObj = this.likemojis.find(x => x.id === likemojiID);\r\n            }\r\n            catch (e){\r\n                alert (`${likemoji} is an invalid ID for likemojis`);\r\n            }\r\n\r\n        }\r\n        else {\r\n            likemojiObj = likemoji;\r\n            likemojiID = likemojiObj.id;\r\n        }\r\n        // limit main category to 3 likemojis\r\n        if (isMainCategory(category)) {\r\n            maxCount = 3;\r\n        }\r\n\r\n        let catLikemojiIDs = category.get('likemojis');\r\n        if (catLikemojiIDs.length >= maxCount) {\r\n           alert('This section only allows 3 Likemojis');\r\n        }\r\n        else {\r\n        // don't add if it is already in the list\r\n            if (!catLikemojiIDs.find(x => x == likemojiID)) {\r\n                catLikemojiIDs.push(likemojiID);\r\n                category.set('likemojis', catLikemojiIDs);\r\n                likemojiObj.set('OrganizationId', this.channel.id);\r\n                likemojiObj.set('organizationName', this.channel.get('name'));\r\n                await likemojiObj.save();\r\n                // TODO move to button action to \"save\" await category.save();\r\n            }\r\n        }\r\n    },\r\n    removeCategoryLikemoji: async function(category, likemojiID)  {\r\n        // get the array of likemoji pointer from group\r\n        let catLikemojiIDs = category.get('likemojis');\r\n        // find the array index of the given likemoji\r\n        let ind = catLikemojiIDs.findIndex(x => x === likemojiID);\r\n        if(ind > -1) {\r\n            catLikemojiIDs.splice(ind, 1);\r\n            category.set('likemojis', catLikemojiIDs);\r\n            // TODO move to button action to \"save\" await category.save();\r\n        }\r\n    },\r\n    setCategoryOrder: function(ids, orders)  {\r\n        // TODO run category ordering through here to ensure the\r\n        // array and order attributes are in synch\r\n    },\r\n\r\n    get mainCategory()  {\r\n        let mainCat = this.categories.filter(isMainCategory);\r\n        return mainCat[0]; //filter returns array here\r\n    },\r\n\r\n    get subCategories() {return this.categories.filter(function(cat) {return !isMainCategory(cat)})},\r\n    get channelStyle() {return this.styles[0]},\r\n\r\n    saveAll: function() {\r\n        Promise.all([\r\n            this.styles.saveAll(),\r\n            this.categories.saveAll(),\r\n            this.likemojis.saveAll(),\r\n            this.channel.save()])\r\n            .then( () => {return})\r\n            .catch(error => {\r\n                console.log(error.message)\r\n              });\r\n    },\r\n\r\n    updateViews: function() {\r\n        viewControl.update();\r\n    }\r\n}\r\n\r\n/*  need to incorporate this logic\r\n    editors.push(currentUser.id);\r\n    organization.set(\"header\", returnedOrg.attributes.header);\r\n    organization.set(\"callOut\", returnedOrg.attributes.callOut);\r\n    organization.set(\"editors\", editors);\r\n*/\r\n\r\nfunction isMainCategory(category) {\r\n    return category.attributes.main == 1;\r\n}\r\n\r\nasync function getOrgCategories(orgId) {\r\n    const query = new Parse.Query(\"Group\");\r\n    query.equalTo(\"organizationID\", orgId);\r\n    query.ascending(\"order\");\r\n    try {\r\n        return await query.find();\r\n    } catch (err) {\r\n        // TypeError: failed to fetch\r\n        alert(err);\r\n    }\r\n}\r\n\r\nasync function getLikemojis(orgId) {\r\n    const query = new Parse.Query(Likemoji);\r\n    query.equalTo(\"organizationID\", orgId);\r\n    try {\r\n      return await query.find();\r\n    } catch (err) {\r\n      // TypeError: failed to fetch\r\n      alert(err);\r\n    }\r\n  }\r\n\r\nfunction arrayToPointers(arr, pointerClass) {\r\n    const pointers = arr.map(id => {\r\n        return {\r\n            __type: \"Pointer\",\r\n            className: pointerClass,\r\n            objectId: id\r\n        };\r\n    });\r\n    return pointers;\r\n}\r\nexport {Channel, viewControl};","import {Organization} from \"./organizations.js\";\r\n//Parse.Cloud.define(\"CloneChannel\", async request => {\r\nvar currentUser;\r\n\r\nasync function cloneChannel(req) {\r\n\tconsole.log(`cloneChannel ${req.sourceOrgId} to ${req.targetOrgId}`);\r\n\tvar targetOrg = new Organization();\r\n\tvar sourceOrg = new Organization();\r\n\r\n\tcurrentUser = Parse.User.current();\r\n\t//TODO before we go copy everything to this new organization we have some way of checking it is the correct target?\r\n\r\n\t// TODO allow flexibility to define only a source org and clone it\r\n\t// when no request.targetOrgId is provided\r\n\ttargetOrg = await getOrganization(req.targetOrgId);\r\n\tsourceOrg = await getOrganization(req.sourceOrgId);\r\n\r\n\t//TODO check if name exists before we overwrite it\r\n\ttargetOrg.set(\"name\", \"Clone of \" + sourceOrg.get(\"name\"));\r\n\r\n\t// too many paramters needed for the steps in this\r\n\t// await saveChannelToOrg(groupIDs);\r\n\t// TODO can we make this into a separate block?\r\n\tlet editors = []; //users ids able to edit the channel to populate channel list\r\n\teditors.push(currentUser.id);\r\n\ttargetOrg.set(\"editors\", editors);\r\n\ttargetOrg.set(\"header\", sourceOrg.attributes.header);\r\n\ttargetOrg.set(\"callOut\", sourceOrg.attributes.callOut);\r\n\r\n\t// get all the likemojis for the channel copying from\r\n\t//var likemojis, likemojiIDs, groups;\r\n\tvar groupIDs = [];\r\n\tgetLikemojis(req.sourceOrgId).then(_likemojis => {\r\n\t\tlet likemojis = _likemojis;\r\n\t\tlet likemojiIDs = cloneLikemojis(likemojis, targetOrg) //async .. does it matter\r\n\t\t\t.then(_likemojIDs => {\r\n\t\t\t\tlikemojiIDs = _likemojIDs;\r\n\t\t\t\t// TODO we can probably just keep passing the then return down and not pas back up to outer block scoped variables\r\n\t\t\t\tgetGroups(sourceOrg.id).then(_groups => {\r\n\t\t\t\t\tlet groups = _groups;\r\n\t\t\t\t\tcloneGroups(groups, targetOrg, likemojiIDs).then(_groupIDS => {\r\n\t\t\t\t\t\t// now that we have groupids we can pass that back up into the org record\r\n\t\t\t\t\t\tgroupIDs = _groupIDS;\r\n\t\t\t\t\t\ttargetOrg.set(\"groups\", groupIDs);\r\n\t\t\t\t\t\ttargetOrg.set(\"groupPointer\", arrayToPointers(groupIDs, \"Group\"));\r\n\t\t\t\t\t\ttargetOrg.save().then(\r\n\t\t\t\t\t\t\torg => {\r\n\t\t\t\t\t\t\t\tconsole.log(`org id ${org.id} saved`);\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\terror => {\r\n\t\t\t\t\t\t\t\talert(`Failed to create new object, with error code: ${error.message}`);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t});\r\n\t// cloning likemojis returns a mapping of oldID to newID array\r\n\t//.then( (likemojiIDs) => {groups = getGroups(sourceOrg.id)})\r\n\t// cloning groups returns a mapping of oldID to newID array\r\n\r\n\t//TODO fix this thenable mess. We can call cloneLikemojis and getGroups at the same time\r\n\r\n\tcopyStyleToOrg(sourceOrg.id, targetOrg.id);\r\n\r\n\tconsole.log(\"done\");\r\n}\r\n//);\r\n\r\n//returns an organization object template or channel to edit or clone\r\nasync function getOrganization(orgId) {\r\n\tconst query = new Parse.Query(Organization);\r\n\ttry {\r\n\t\treturn await query.get(orgId);\r\n\t} catch (err) {\r\n\t\t// TypeError: failed to fetch\r\n\t\talert(err);\r\n\t}\r\n}\r\n\r\n//copies given array of Likemoji objects to new organization object\r\nasync function cloneLikemojis(mojis, organization) {\r\n\tconsole.log(\r\n\t\t`cloning ${mojis.length} likemojies to ord id ${organization.id}`\r\n\t);\r\n\t// map each moji to a function that will clone it\r\n\tlet mojiSaveArray = mojis.map(async moji => {\r\n\t\tconst result = await copyMojiToOrg(moji, organization);\r\n\t\t//console.log(result.id);\r\n\t\treturn { oldID: moji.id, newID: result.id };\r\n\t});\r\n\t// execute the entire array of clone calls and return the array of returned values\r\n\tconst resolvedmojiSaveArray = await Promise.all(mojiSaveArray); // resolving all promises\r\n\treturn resolvedmojiSaveArray;\r\n}\r\n\r\nasync function copyMojiToOrg(likemoji, org) {\r\n\tlet newLikemoji = likemoji.clone();\r\n\tnewLikemoji.set(\"organizationID\", org.id);\r\n\tnewLikemoji.set(\"organizationName\", org.get(\"name\"));\r\n\t// TODO this ACL setting could be handled in cloud code beforesave trigger\r\n\tnewLikemoji.setACL(org.getACL());\r\n\tdelete newLikemoji.objectId;\r\n\treturn await newLikemoji.save(); /*.then(function(newLikemoji) {\r\n    return newLikemoji;\r\n      { oldID: newLikemojiID, newID: newLikemoji.id }; //objectId;\r\n  })*/\r\n}\r\n\r\n// return likemojis associated with an org\r\nasync function getLikemojis(orgId) {\r\n\tconst query = new Parse.Query(\"Likemoji\");\r\n\tquery.equalTo(\"organizationID\", orgId);\r\n\ttry {\r\n\t\treturn await query.find();\r\n\t} catch (err) {\r\n\t\t// TypeError: failed to fetch\r\n\t\talert(err);\r\n\t}\r\n}\r\n\r\nasync function cloneGroup (group, organization, likemojiIDs) {\r\n\tlet newGroup = group.clone();\r\n\tnewGroup.set(\"organizationID\", organization.id);\r\n\tnewGroup.set(\"organization\", organization.get(\"name\"));\r\n\t//newGroup.set(\"order\", i);\r\n\tnewGroup.set(\"likemojis\", remapIDs(newGroup.get(\"likemojis\"), likemojiIDs));\r\n\treturn await newGroup.save();\r\n}\r\n\r\n//clone groups\r\nasync function cloneGroups(groups, organization, likemojiIDs) {\r\n\tlet groupSaveArray = groups.map(async group => {\r\n\t\tconst result = await cloneGroup(group, organization, likemojiIDs);\r\n\t\tconsole.log(result.id);\r\n\t\treturn result.id;\r\n\t});\r\n\t// execute the entire array of clone calls and return the array of returned values\r\n\tconst resolvedgroupSaveArray = await Promise.all(groupSaveArray); // resolving all promises\r\n\treturn resolvedgroupSaveArray;\r\n}\r\n\r\n//clone style\r\nfunction copyStyleToOrg(fromOrgID, toOrgID) {\r\n\tconst ChannelStyle = Parse.Object.extend(\"ChannelStyle\");\r\n\tvar newStyle = new ChannelStyle(); // new channel for new organization being created\r\n\tvar styles = new ChannelStyle();\r\n\tgetStyle(fromOrgID).then(_styles => {\r\n\t\tstyles = _styles;\r\n\t\tnewStyle = styles[0].clone();\r\n\t\tnewStyle.set(\"organizationID\", toOrgID);\r\n\t\tnewStyle.save().then(\r\n\t\t\tstyle => {\r\n\t\t\t\t// Execute any logic that should take place after the object is saved.\r\n\t\t\t\tconsole.log(`New object created with objectId:${style.id}`);\r\n\t\t\t},\r\n\t\t\terror => {\r\n\t\t\t\t// Execute any logic that should take place if the save fails. error is a\r\n\t\t\t\t// Parse.Error with an error code and message.\r\n\t\t\t\talert(`Failed to create new object, with error code: ${error.message}`);\r\n\t\t\t}\r\n\t\t);\r\n\t});\r\n}\r\n\r\n// return styles associated with an org\r\nasync function getStyle(orgId) {\r\n\tvar query = new Parse.Query(\"ChannelStyle\");\r\n\tquery.equalTo(\"organizationID\", orgId);\r\n\ttry {\r\n\t\t// store styles query result in styles array\r\n\t\treturn await query.find();\r\n\t} catch (err) {\r\n\t\t// TypeError: failed to fetch\r\n\t\talert(err);\r\n\t}\r\n}\r\n\r\n// return groups associated with an org\r\n\r\nasync function getGroups(orgId) {\r\n\tconst query = new Parse.Query(\"Group\");\r\n\tquery.equalTo(\"organizationID\", orgId);\r\n\tquery.ascending(\"order\");\r\n\ttry {\r\n\t\treturn await query.find();\r\n\t} catch (err) {\r\n\t\t// TypeError: failed to fetch\r\n\t\talert(err);\r\n\t}\r\n}\r\n\r\n// given an array of objectids and an array of object {oldID: x, newID: y}\r\n// attempts to find the x value and return the y\r\n// not found returns a null which is then filtered out of te returned array\r\nfunction remapIDs(sourceArray, mappingArray) {\r\n  var mapp = mappingArray;\r\n\tconst lookup = function(findID){\r\n\t\treturn mapp.find(x => x.oldID === findID).newID;\r\n\t}\r\n\r\n\tconst remappedIDs = sourceArray\r\n\t\t.map(id => {\r\n\t\t\ttry {\r\n\t\t\t\tlet newid = lookup(id); // mappingArray.find(x => x.oldID === id).newID;\r\n\t\t\t\treturn newid;\r\n\t\t\t} catch (err) {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t})\r\n\t\t.filter(function(el) {\r\n\t\t\treturn el != null;\r\n\t\t});\r\n\treturn remappedIDs;\r\n}\r\n\r\nfunction arrayToPointers(arr, pointerClass) {\r\n\tconst pointers = arr.map(id => {\r\n\t\treturn {\r\n\t\t\t__type: \"Pointer\",\r\n\t\t\tclassName: pointerClass,\r\n\t\t\tobjectId: id\r\n\t\t};\r\n\t});\r\n\treturn pointers;\r\n}\r\n\r\nexport default cloneChannel;","//likemojis.js\r\n//const Likemoji = Parse.Object.extend(\"Likemoji\");\r\n//var likemoji = Parse.Object.extend(\"Likemoji\");\r\n\r\n/* A \"standard\" Parse object extend format \r\nvar MyClass = Parse.Object.extend(\"MyClass\", {\r\n        Instance methods,\r\n        initialize: function(attrs, options) {\r\n            this.someInstanceProperty = [],\r\n            Other instance properties\r\n        }\r\n    }, {\r\n        Class properties\r\n    });\r\n */\r\n\r\nvar Likemoji = Parse.Object.extend(\"Likemoji\", {\r\n      cloneMojies:  (mojis) => {return cloneLikemojies(mojis)}\r\n    , getLikemojis: (orgId)  => {return getLikemojis(orgId)}\r\n    , sortName:     (mojis)  => {return sortMojisByName(mojis)}\r\n});\r\n\r\n//copies given Likemojis to current Likemoji set\r\nasync function cloneLikemojis(mojies) {\r\n    let newLikemojisArray = [];\r\n    let intermediateLikemojisArray = [];\r\n    for (var i = 0; i < mojis.length; i++) {\r\n      var newLikemoji = mojis[i].clone();\r\n      newLikemoji.set(\"organizationID\", organization.id);\r\n      newLikemoji.set(\"organizationName\", organization.get(\"name\"));\r\n      newLikemojisArray[i] = newLikemoji;\r\n      // add attribute to store the original ID\r\n      newLikemojisArray[i].copiedFromID = mojis[i].id;\r\n    }\r\n    // saving to Parse without added attribute\r\n    intermediateLikemojisArray = newLikemojisArray;\r\n    delete intermediateLikemojisArray.copiedFromID;\r\n    Parse.Object.saveAll(intermediateLikemojisArray);\r\n    return newLikemojisArray;\r\n  };\r\n\r\n// iterate through categoriesSorted array likemojis property array\r\n// to store index relating to old likemoji ids\r\n// and create new arrays of new likemojis based on old indexs\r\n// and save to newGroupsLikemojis array.\r\n\r\nfunction setNewGroupLikemojisArray() {\r\n  var importedLikemojisIDs = [];\r\n  var newLikemojisArrayIDs = [];\r\n  var newGroupLikemojis = [];\r\n  for (var i = 0; i < importedLikemojis.length; i++) {\r\n    importedLikemojisIDs[i] = importedLikemojis[i].id;\r\n    newLikemojisArrayIDs[i] = newLikemojisArray[i].id;\r\n  }\r\n\r\n  for (var i = 0; i < categoriesSorted.length; i++) {\r\n    // console.log (categoriesSorted[i].attributes.likemojis.length)\r\n    newGroupLikemojis = [];\r\n\r\n    for (var j = 0; j < categoriesSorted[i].attributes.likemojis.length; j++) {\r\n      var likemojiID = categoriesSorted[i].attributes.likemojis[j];\r\n      var oldLikemojiIndex = importedLikemojisIDs.indexOf(likemojiID);\r\n\r\n      newGroupLikemojis[j] = newLikemojisArrayIDs[oldLikemojiIndex];\r\n    }\r\n\r\n    newGroupsLikemojis[i] = newGroupLikemojis;\r\n  }\r\n\r\n  return newGroupLikemojis;\r\n}\r\n\r\n// return likemojis associated with an org\r\nasync function getLikemojis(orgId) {\r\n  const query = new Parse.Query(Likemoji);\r\n  query.equalTo(\"organizationID\", orgId);\r\n\r\n  try {\r\n    return await query.find();\r\n  } catch (err) {\r\n    // TypeError: failed to fetch\r\n    alert(err);\r\n  }\r\n}\r\nasync function sortMojisByName(mojis) {\r\n  return mojis.sort(SortByName);\r\n}\r\n\r\nfunction SortByName(a, b) {\r\n\tvar aName = a.attributes.name.toLowerCase();\r\n\tvar bName = b.attributes.name.toLowerCase();\r\n\treturn aName < bName ? -1 : aName > bName ? 1 : 0;\r\n}\r\n\r\nexport default Likemoji;","// organizations.js \r\n//prototype object for Organization class from Parse\r\n\r\n/* A \"standard\" Parse object extend format \r\nvar MyClass = Parse.Object.extend(\"MyClass\", {\r\n        Instance methods,\r\n        initialize: function(attrs, options) {\r\n            this.someInstanceProperty = [],\r\n            Other instance properties\r\n        }\r\n    }, {\r\n        Class properties\r\n    });\r\n */\r\n\r\nvar Organization = Parse.Object.extend(\"Organization\", {\r\n\tsaveChannelToOrg: () => {saveChannelToOrg()}\r\n  , getOrganization: (orgId) => {getOrganization(orgId)} \r\n});\r\n\r\n//TODO do we need to do this? \r\n// docs say only for ES6 class/subclass syntax \r\n// Parse.Object.registerSubclass(\"Organization\", Organization);\r\n\r\n//TODO don't we want paramters for saveChannelToOrg?\r\n\r\n\r\n//TODO extend or delegate from base class not Parse                \r\nvar returnedOrg = Parse\r\n\t\t\t\t.Object\r\n\t\t\t\t.extend(\"Organization\"); // imported organization\r\n\r\n\r\n//returns and organization object template or channel to edit\r\n// or clone\r\nasync function getOrganization(orgId) {\r\n\r\n    const query = new Parse.Query(Organization);\r\n\r\n    try {\r\n        return await query.get(orgId);\r\n    } catch (err) {\r\n        // TypeError: failed to fetch\r\n        alert(err);\r\n    }\r\n}\r\n\r\nfunction saveChannelToOrg() {\r\n    // should rename groups to channels..?\r\n    let organization = new Organization(); // new organization being created\r\n\r\n    editors.push(currentUser.id);\r\n\r\n    organization.set(\"groups\", groupsIDs);\r\n    organization.set(\"groupPointer\", groupPointers);\r\n    organization.set(\"header\", returnedOrg.attributes.header);\r\n    organization.set(\"callOut\", returnedOrg.attributes.callOut);\r\n    organization.set(\"editors\", editors);\r\n\r\n    organization\r\n        .save()\r\n        .then((org) => {\r\n            // Execute any logic that should take place after the object is saved.\r\n            // console.log(\"org saved\"); alert('Organization updated with channel: ' +\r\n            // org.id);\r\n        }, (error) => {\r\n            // Execute any logic that should take place if the save fails. error is a\r\n            // Parse.Error with an error code and message.\r\n            alert('Failed to create new object, with error code: ' + error.message);\r\n        });\r\n}\r\n\r\nexport {Organization, getOrganization};","//channelstyles.js  styles\r\nconst ChannelStyle = Parse\r\n\t\t\t\t.Object\r\n\t\t\t\t.extend(\"ChannelStyle\");\r\n\r\nfunction saveNewStyle() {\r\n\r\n    newStyle = styles[0].clone()\r\n\r\n    newStyle.set(\"organizationID\", organization.id)\r\n\r\n    newStyle\r\n        .save()\r\n        .then((style) => {\r\n            // Execute any logic that should take place after the object is saved.\r\n            // alert('New object created with objectId: ' + style.id);\r\n\r\n        }, (error) => {\r\n            // Execute any logic that should take place if the save fails. error is a\r\n            // Parse.Error with an error code and message.\r\n            alert('Failed to create new object, with error code: ' + error.message);\r\n        });\r\n}\r\n\r\n// return styles associated with an org\r\nasync function getStyle(orgId) {\r\n\r\n    var query = new Parse.Query(ChannelStyle);\r\n    query.equalTo(\"organizationID\", orgId);\r\n\r\n    try {\r\n        // store styles query result in styles array\r\n        return await query.find();\r\n\r\n    } catch (err) {\r\n        // TypeError: failed to fetch\r\n        alert(err);\r\n\r\n    }\r\n}\r\n\r\nexport {ChannelStyle, saveNewStyle, getStyle};","//users.js returns list of channels for current user\r\n// turns out exgedning user object is a little more involved. \r\n// if needed check out the example in extendedUserExample.js\r\n//var User = Parse.Object.extend(\"User\");\r\n\r\nasync function getUserChannels(userId) {\r\n    const query = new Parse.Query(\"Organization\");\r\n    query.equalTo(\"editors\", userId);\r\n\r\n    try {\r\n        return await query.find();\r\n    } catch (err) {\r\n        // TypeError: failed to fetch\r\n        alert(err);\r\n    }\r\n}\r\n\r\n//sign up / create new user\r\nasync function newUser (email, password) {\r\n    // TODO handle user already exists first\r\n    console.log(\"function called\")\r\n    console.log(email + \" \" + password)\r\n\r\n    let user = new Parse.User(); \r\n    let currentUser;\r\n    //TODO I think here we use the outer User object this method is called from\r\n    // in other words \"this\"\r\n    \r\n    user.set(\"username\", email);\r\n    user.set(\"password\", password);\r\n    user.set(\"email\", email);\r\n\r\n    // other fields can be set just like with Parse.Object user.set(\"phone\", \"\");\r\n    try {\r\n        await user.signUp();\r\n        currentUser = await Parse\r\n            .User\r\n            .current();\r\n\r\n        console.log(\"user is signed up\")\r\n    } catch (error) {\r\n        // Show the error message somewhere and let the user try again.\r\n        alert(\"Error: \" + error.code + \" \" + error.message);\r\n        console.log(\"not signed up\")\r\n    }\r\n    return currentUser;\r\n}\r\n\r\n//logs user in\r\nasync function userLogin (email, password)  {\r\n    \r\n    /*\r\n    const user = await Parse\r\n        .User\r\n        .logIn(email, password);\r\n    */\r\n    this.logIn(email, password)\r\n        .then(user => {return user})\r\n        .catch(error => {alert(error)});\r\n\r\n}\r\n\r\nasync function logout() {\r\n    Parse\r\n        .User\r\n        .logOut()\r\n        .then(() => {\r\n            currentUser = Parse\r\n                .User\r\n                .current(); // this will now be null\r\n            if (currentUser) {\r\n                console.log(\"loggedin\")\r\n            } else {\r\n                console.log(\"loggedout\")\r\n\r\n                window.location.href = 'file:///Users/alexbarrett/Desktop/likemoji%20website%20and%20builder/likemoji%20' +\r\n                        'builder/buildChannel.html';\r\n            }\r\n        });\r\n}\r\n\r\nexport {getUserChannels, newUser};\r\n","const {render, html, svg} = lighterhtml;\r\nconst viewControl = {\r\n    views: []\r\n};\r\n\r\nviewControl.add = function (target, source) {\r\n    let key = viewControl.views.find( x => x.target === target);\r\n    if (key) {\r\n        key.source = source;\r\n    }\r\n    else {\r\n        let viewDef = {target: target, source: source};\r\n        viewControl.views.push(viewDef);\r\n    }\r\n    console.log(`added key ${target}`);\r\n    render(target, source);\r\n}\r\n\r\nviewControl.deleteView = function (target) {\r\n    let key = viewControl.views.find( x => x.target === target);\r\n    if (key) {\r\n        let deleted = viewControl.views.splice(key);\r\n        console.log('deleted view' + target.id);\r\n    }\r\n    render(target, () => html`<span />`);\r\n}\r\n\r\nviewControl.deleteAll = function () {\r\n    viewControl.views.forEach(x => viewControl.deleteView(x.target));\r\n    //viewControl.views = [];\r\n}\r\n\r\nviewControl.update = function () {\r\n    //get object keys\r\n    //find each target or create if not exists??? TODO should we only allow existing elements here?\r\n    //and render them\r\n    //\r\n    let renders = viewControl.views;\r\n    console.log(renders);\r\n    renders.forEach(x => render(x.target, x.source));\r\n}\r\n\r\nexport default viewControl;","const {render, html, svg} = lighterhtml;\r\n\r\nconst catLeftView = (categories) => {\r\n    //TODO what is a better way to keep this view from knowing about the other parts of the page\r\n\tconsole.info('rendering catLeftView');\r\n    function togglePanelWithin(panelName, parentName) {\r\n        let panel, parent;\r\n        panel = document.getElementById(panelName);\r\n        if (panel) {\r\n            parent = document.getElementById(parentName);\r\n            if (parent){\r\n                for (var i = 0; i < parent.children.length; i++) {\r\n                    parent.children[i].classList.add('hidden');\r\n                  }\r\n                panel.classList.remove('hidden');\r\n            }\r\n            else {\r\n                console.warn(`panel ${parentName} not found`);\r\n            }\r\n        }\r\n        else {\r\n            console.warn(`panel ${panelName} not found`);\r\n        }\r\n    }\r\n\r\n    function callCategoriesEditor (e) {\r\n        e.preventDefault();\r\n        togglePanelWithin('panel-categories', 'panel3');\r\n    }\r\n\r\n    function callCategoryEditor (e) {\r\n        e.preventDefault();\r\n        togglePanelWithin('panel-editor', 'panel3');\r\n    }\r\n\r\n    function callLikemojiEditor (e) {\r\n        e.preventDefault();\r\n        togglePanelWithin('panel-likemojis', 'panel3');\r\n    }\r\n\r\n    return html`<div>\r\n        <h3>Design & Edit Your Channel</h3>\r\n        <hr />\r\n        <div>\r\n            <ul>\r\n                <li><h4>Customize the look and feel</h4></li>\r\n                <li><h4>Drag Likemojis in or out</h4></li>\r\n                <li><h4>Sort or disable Categories</h4></li>\r\n            </ul>\r\n        </div>\r\n        <hr />\r\n        <div class=\"selectDiv text-center\">\r\n            <button\r\n                id=\"addHeader\"\r\n                type=\"button\"\r\n                class=\"btn btn-default active editor\"\r\n                aria-pressed=\"true\"\r\n                onclick=\"${callCategoryEditor}\"\r\n            >\r\n                Edit Page\r\n            </button>\r\n            <!-- \t<p>Upload header image - (1242px  704px)</p></center> -->\r\n        </div>\r\n        <div class=\"selectDiv text-center\">\r\n            <button id=\"addLikemojis\" type=\"button\" class=\"btn btn-default editor\"  onclick=\"${callLikemojiEditor}\">\r\n                Add/Edit Likemojis\r\n            </button>\r\n            <!-- <p>Upload likemojis - (324px  324px)</p></center> -->\r\n        </div>\r\n        <div id=\"categoryEditorButton\" class=\"selectDiv text-center\">\r\n            <button id=\"addCategories\" type=\"button\" class=\"btn btn-default editor\" onclick=\"${callCategoriesEditor}\">\r\n                Add/Edit Categories\r\n            </button>\r\n            <!-- <p>Upload category image - (1242px  312px)</p></center> -->\r\n        </div>\r\n        <div id=\"afterEditorButton\" class=\"selectDiv text-center\">\r\n            <button id=\"afterEditing\" type=\"button\" class=\"btn btn-default editor\">\r\n                Next\r\n            </button>\r\n            <!-- <p>Upload category image - (1242px  312px)</p></center> -->\r\n        </div>\r\n        <div id=\"cancelSaveGroup\" class=\"selectDiv text-center\" style=\"display:none\">\r\n            <div class=\"btn-group \" role=\"group\" aria-label=\"...\">\r\n                <button\r\n                    id=\"cancelLikemojiAdd\"\r\n                    type=\"button\"\r\n                    class=\"btn btn-danger\"\r\n                    aria-pressed=\"true\"\r\n                >\r\n                    cancel\r\n                </button>\r\n                <button id=\"saveLikemojiAdd\" type=\"button\" class=\"btn btn-success active\">\r\n                    save\r\n                </button>\r\n            </div>\r\n            <p>(Save Likemojis to Current View)</p>\r\n        </div>\r\n        <div\r\n            id=\"phoneDisplayBackButton\"\r\n            class=\"selectDiv text-center\"\r\n            style=\"display:none\"\r\n        >\r\n            <button id=\"backFromGroup\" type=\"button\" class=\"btn btn-default editorBack\">\r\n                <i class=\"fas fa-chevron-left\"></i> Back\r\n            </button>\r\n        </div>\r\n    </div>`;\r\n}\r\n\r\nexport default catLeftView;","const {render, html, svg} = lighterhtml;\r\n\r\n//const categoriesEditorView = categories => {\r\nconst categoriesEditorView = (Channel) => {\r\n\tconsole.info('rendering categoriesEditorView');\r\n\tlet selectedItem;\r\n\tlet categoriesEditorViewHTML = html`\r\n\t<div id=\"categoriesEditor\"\r\n\t\tclass=\"editorWindow\"\r\n\t\tondragover=\"${handleDrag}\"\r\n\t>\r\n\t\t<h3>Edit Categories</h3>\r\n\t\t<hr />\r\n\t\t<div id=\"editorContainer\" class=\"image upload\">\r\n\t\t\t<h4 style=\"display:inline\">Click to edit / Drag to reorder:</h4>\r\n\t\t\t<ul id=\"categoriesInEditor\">\r\n\t\t\t\t${Channel.categories.map((cat, index) =>\r\n\t\t\t\t\tcat.attributes.main != 1\r\n\t\t\t\t\t? html`<li\r\n\t\t\t\t\t\t\t\tid=\"${cat.id+index}\"\r\n\t\t\t\t\t\t\t\tdata-i=\"${cat.id}\"\r\n\t\t\t\t\t\t\t\tdata-toggle=\"modal\"\r\n\t\t\t\t\t\t\t\tdata-target=\"#addCategoriesModal\"\r\n\t\t\t\t\t\t\t\tclass=\"${cat.attributes.disable == 1 ? 'disabledCategory' : 'test'}\"\r\n\t\t\t\t\t\t\t\tdraggable=\"true\"\r\n\t\t\t\t\t\t\t\tondragend=\"${handleDrop}\"\r\n\t\t\t\t\t\t\t\tondragstart=\"${handleDragStart}\"\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<i class=\"fas fa-sort\"></i>\r\n\t\t\t\t\t\t\t\t<i class=\"fas fa-edit floatRight\"></i>\r\n\t\t\t\t\t\t\t\t<p class=\"inlineDisplay\">${cat.attributes.name}</p>\r\n\t\t\t\t\t\t\t\t<span class=\"ui-icon ui-icon-arrowthick-2-n-s\"></span>\r\n\t\t\t\t\t\t\t</li>`\r\n\t\t\t\t\t: html``\r\n\t\t\t)}\r\n\t\t\t</ul>\r\n\t\t</div>\r\n\t\t<div class=\"selectDiv text-center\">\r\n\t\t\t<button\r\n\t\t\t\ttype=\"button\"\r\n\t\t\t\tid=\"addNewCategories\"\r\n\t\t\t\tclass=\"btn btn-default addCategories\"\r\n\t\t\t\tdata-toggle=\"modal\"\r\n\t\t\t\tdata-target=\"#addCategoriesModal\"\r\n\t\t\t\t>\r\n\t\t\t\t<i\r\n\t\t\t\t\tstyle=\"font-size: 1.3em; color: white; margin-top: 4px;\"\r\n\t\t\t\t\tclass=\"far fa-plus-square grow\"\r\n\t\t\t\t></i>\r\n\t\t\t\tAdd Categories\r\n\t\t\t</button>\r\n\t\t</div>\r\n\t</div>`;\r\n\r\n\tfunction handleDragStart(event) {\r\n\t\tconsole.info('drag starting');\r\n\t\tevent.dataTransfer.setData(\"text/plain\", \"Text to drag\");\r\n\t\tselectedItem = event.target;\r\n\t\t// set target on start so the dragover listener can handle the swapping\r\n\t\t// firsfox won't give us clientX and clientY on the drag event..just dragover\r\n\t}\r\n\r\n\tfunction handleDrag(event) {\r\n\t\tconsole.info('drag happening');\r\n\t\tconst list = selectedItem.parentNode,\r\n\t\t\tx = event.clientX,\r\n\t\t\ty = event.clientY;\r\n\r\n\t\tselectedItem.classList.add('drag-sort-active');\r\n\t\tlet swapItem = document.elementFromPoint(x, y) === null ? selectedItem : document.elementFromPoint(x, y);\r\n\t\t// TODO a more functional approach would be to just look at keys being swapped and send them to the model as actions\r\n\t\tif (list === swapItem.parentNode) {\r\n\t\t\tswapItem = swapItem !== selectedItem.nextSibling ? swapItem : swapItem.nextSibling;\r\n\t\t\tlist.insertBefore(selectedItem, swapItem);\r\n\t\t}\r\n\t}\r\n\r\n\tasync function handleDrop(event) {\r\n\t\tevent.target.classList.remove('drag-sort-active');\r\n\t\tawait setNewGroupOrder();\r\n\t\tconsole.info('categories sorted now refresh views');\r\n\t\t// seems we like dom manipulation in page messes up the render cycle\r\n\t\t// so we need to just blank this panel and let it rerender\r\n\t\tlet elem = document.getElementById('panel-categories');\r\n\t\trender(elem, () => html``);\r\n\t\tChannel.updateViews();\r\n\t}\r\n\r\n\t//sets group order to order that was set in the dragable editor\r\n\tasync function setNewGroupOrder() {\r\n\t\t//user catOrder above to update all groups order\r\n\t\tlet catOrder = document.querySelectorAll('#categoriesInEditor li');\r\n\t\tfor (var i = 0; i < catOrder.length; i++) {\r\n\t\t\tlet thisID = catOrder[i].dataset.i;\r\n\t\t\tlet group = Channel.categories.find(x => x.id === thisID);\r\n\t\t\tlet order = i + 1;\r\n\t\t\tgroup.set(\"order\", order);\r\n\t\t}\r\n\t\tawait Parse.Object.saveAll(Channel.categories);\r\n\t\tChannel.categories.sort(function (a,b) {\r\n\t\t\t\t\tconsole.info('category array sort element');\r\n\t\t\t\t\treturn a.get('order') - b.get('order');\r\n\t\t\t\t});\r\n\t\treturn;\r\n\t}\r\n\r\n\tconsole.log(categoriesEditorViewHTML);\r\n\treturn categoriesEditorViewHTML;\r\n}\r\n\r\nexport default categoriesEditorView;","const {render, html, svg} = lighterhtml;\r\n\r\n//const categoryEditorView = (category) => {\r\nconst categoryEditorView = (Channel) => {\r\n\tconsole.info('rendering categoryEditorView');\r\n\tlet category = Channel.selectedCategory;\r\n\tlet callOut = category.attributes.callOuts.en;\r\n\tlet description;\r\n\ttry { description = category.attributes.descriptions.en;}\r\n\t  catch (e) {description = '';}\r\n\r\n\t  console.info(`description = ${description}`);\r\n\tasync function saveCallToAction (e) {\r\n\t\tvar callOutText = document.getElementById(\"editorCallOut\").value;\r\n\t\tvar callOutsObject = {\r\n\t\t\ten: callOutText\r\n\t\t};\r\n\t\t//TODO check if this is a change before wasting effort to call Parse\r\n\t\tcategory.set(\"callOuts\", callOutsObject);\r\n\t\tcategory.save().then(\r\n\t\t\tgroup => {\r\n\t\t\t\t//rerender the phone\r\n\t\t\t\tChannel.updateViews();\r\n\t\t\t},\r\n\t\t\terror => {\r\n\t\t\t\t// Execute any logic that should take place if the save fails. error is a\r\n\t\t\t\t// Parse.Error with an error code and message.\r\n\t\t\t\talert(\"Failed to create new object, with error code: \" + error.message);\r\n\t\t\t}\r\n\t\t);\r\n\t};\r\n\r\n\tasync function saveExtendedInfo (e) {\r\n\t\tlet extendedInfoText = document.getElementById('categoryExtendedInfo').value;\r\n\t\tlet extenedInfoObject = {en: extendedInfoText};\r\n\t\tcategory.set(\"descriptions\", extenedInfoObject);\r\n\t\tcategory.save().then(\r\n\t\t\tgroup => {\r\n\t\t\t\t// Execute any logic that should take place after the object is saved.\r\n\t\t\t},\r\n\t\t\terror => {\r\n\t\t\t\t// Execute any logic that should take place if the save fails. error is a\r\n\t\t\t\t// Parse.Error with an error code and message.\r\n\t\t\t\talert(\"Failed to create new object, with error code: \" + error.message);\r\n\t\t\t}\r\n\t\t);\r\n\t};\r\n\r\n\tlet categoryEditorViewHTML = html`<div id=\"categoryEditor\" class=\"channelEdit\">\r\n\t\t\t<div\r\n\t\t\t\tid=\"imageUploaderButtons\"\r\n\t\t\t\tclass=\"btn-group\"\r\n\t\t\t\trole=\"group\"\r\n\t\t\t\taria-label=\"...\"\r\n\t\t\t>\r\n\t\t\t\t<button\r\n\t\t\t\t\tid=\"uploadHeader\"\r\n\t\t\t\t\tclass=\"btn btn-editorUploadSwitch active\"\r\n\t\t\t\t\tdata-toggle=\"modal\"\r\n\t\t\t\t\tdata-target=\"#editheaderModal\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<label>\r\n\t\t\t\t\t\t<i\r\n\t\t\t\t\t\t\tstyle=\"font-size: 1.3em; color: white;\"\r\n\t\t\t\t\t\t\tclass=\"fas fa-file-upload\"\r\n\t\t\t\t\t\t></i>\r\n\t\t\t\t\t\t<h5 style=\"display:inline\">upload</h5>\r\n\t\t\t\t\t</label>\r\n\t\t\t\t</button>\r\n\t\t\t\t<button\r\n\t\t\t\t\tid=\"unsplashSearchModal\"\r\n\t\t\t\t\tclass=\"btn btn-editorUploadSwitch\"\r\n\t\t\t\t\tdata-toggle=\"modal\"\r\n\t\t\t\t\tdata-target=\"#unsplashModal\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<label>\r\n\t\t\t\t\t\t<i\r\n\t\t\t\t\t\t\tstyle=\"font-size: 1.3em; color: white;\"\r\n\t\t\t\t\t\t\tclass=\"fas fa-camera\"\r\n\t\t\t\t\t\t></i>\r\n\t\t\t\t\t\t<h5 style=\"display:inline\">unsplash</h5>\r\n\t\t\t\t\t</label>\r\n\t\t\t\t</button>\r\n\t\t\t</div>\r\n\t\t\t<br />\r\n\t\t\t<p>Name: ${category.attributes.name}</p>\r\n\t\t\t<label for=\"editorCallOut\">Call to Action:</label>\r\n\t\t\t<div class=\"input-group\">\r\n\t\t\t\t<input\r\n\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\tclass=\"form-control\"\r\n\t\t\t\t\tid=\"editorCallOut\"\r\n\t\t\t\t\tplaceholder=\"Let us know how we're doing...\"\r\n\t\t\t\t\tvalue=\"${callOut}\"\r\n\t\t\t\t/>\r\n\t\t\t\t<div class=\"input-group-btn\">\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tid=\"callToActionSave\"\r\n\t\t\t\t\t\tclass=\"btn btn-callToAction\"\r\n\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\tonclick=${saveCallToAction}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tsave\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<br />\r\n\r\n\t\t\t<div class=\"btn-group\" role=\"group\" aria-label=\"...\">\r\n\t\t\t\t<button\r\n\t\t\t\t\tid=\"\"\r\n\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\tclass=\"btn btn-likemojiSwitch\"\r\n\t\t\t\t\taria-pressed=\"true\"\r\n\t\t\t\t>\r\n\t\t\t\t\tOff\r\n\t\t\t\t</button>\r\n\t\t\t\t<button id=\"\" type=\"button\" class=\"btn btn-likemojiSwitch active\">\r\n\t\t\t\t\tOn\r\n\t\t\t\t</button>\r\n\t\t\t</div>\r\n\t\t\t<label> - Likemojis Outline Stroke</label> <br />\r\n\t\t\t<br />\r\n\t\t\t<button id=\"editTheme\" class=\"btn btn-editTheme\" onclick=\"${callStyleEditor}\">\r\n\t\t\t\t<label>\r\n\t\t\t\t\t<i\r\n\t\t\t\t\t\tclass=\"fas fa-edit\"\r\n\t\t\t\t\t\tstyle=\"font-size: 1.3em; display:inline\"\r\n\t\t\t\t\t></i>\r\n\t\t\t\t\t<h5 style=\"display:inline\">Edit</h5>\r\n\t\t\t\t</label>\r\n\t\t\t</button>\r\n\t\t\t<label> - Edit Theme (Color / Font)</label> <br />\r\n\t\t\t<br />\r\n\t\t\t<button id=\"editExtendedInfo\" class=\"btn btn-editTheme\" onclick=${saveExtendedInfo}>\r\n\t\t\t\t<label>\r\n\t\t\t\t\t<i\r\n\t\t\t\t\t\tclass=\"fas fa-save\"\r\n\t\t\t\t\t\tstyle=\"font-size: 1.3em; display:inline\"\r\n\t\t\t\t\t></i>\r\n\t\t\t\t\t<h5 style=\"display:inline\">Save</h5>\r\n\t\t\t\t</label>\r\n\t\t\t</button>\r\n\t\t\t<label style=\"display:inline\" for=\"categoryExtendedInfo\"\r\n\t\t\t\t>- Info Text:\r\n\t\t\t\t<i style=\"display:inline\" class=\"fas fa-info-circle\"></i\r\n\t\t\t></label>\r\n\t\t\t<div class=\"form-group infoDiv\">\r\n\t\t\t\t<textarea\r\n\t\t\t\t\tid=\"categoryExtendedInfo\"\r\n\t\t\t\t\tclass=\"form-control infoTextField\"\r\n\t\t\t\t\trows=\"5\"\r\n\t\t\t\t\tplaceholder=\"Here at XYZ Corp, We know that want to put your experience first...\"\r\n\t\t\t\t\tvalue=\"${description}\"\r\n\t\t\t\t>\r\n\t\t\t\t</textarea>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>`;\r\n\r\n\tfunction callStyleEditor (e) {\r\n\t\te.preventDefault();\r\n\t\ttogglePanelWithin('panel-style-editor', 'panel3');\r\n\t}\r\n\r\n\r\n\treturn categoryEditorViewHTML;\r\n}\r\n\r\nfunction togglePanelWithin(panelName, parentName) {\r\n    let panel, parent;\r\n    panel = document.getElementById(panelName);\r\n    if (panel) {\r\n        parent = document.getElementById(parentName);\r\n        if (parent){\r\n            for (var i = 0; i < parent.children.length; i++) {\r\n                parent.children[i].classList.add('hidden');\r\n              }\r\n            panel.classList.remove('hidden');\r\n        }\r\n        else {\r\n            console.warn(`panel ${parentName} not found`);\r\n        }\r\n    }\r\n    else {\r\n        console.warn(`panel ${panelName} not found`);\r\n    }\r\n}\r\n\r\nexport default categoryEditorView;","import {phoneView} from './phoneView.js';\r\nconst {render, html, svg} = lighterhtml;\r\n\r\n//const likemojisListView = (likemojis) => {\r\nconst likemojisListView = (Channel) => {\r\n\tconsole.info('rendering likemojisListView');\r\n    let panel2 = document.getElementById(\"panel2\");\r\n    function dragMoji(e) {\r\n        e.dataTransfer.setData('Text', e.currentTarget.id + ',add' );\r\n    }\r\n\r\n    function handleDrop(e) {\r\n        e.preventDefault();\r\n        // find object dropped..get the id\r\n        //alert('droped moji with id: ' + e.dataTransfer.getData('Text'));\r\n        let mojiID = e.dataTransfer.getData('Text');\r\n        // storing data in drag event as \"ID,add\" or \"ID,remove\"\r\n        let dropEvent = e.dataTransfer.getData('Text').split(',');\r\n        if (dropEvent[1] === 'remove') {\r\n            // add it\r\n            Channel.removeCategoryLikemoji(Channel.selectedCategory, dropEvent[0])\r\n            .then(render(panel2, () => phoneView(Channel)))\r\n        }\r\n    }\r\n\r\n    function dragover(e) {\r\n        e.preventDefault()\r\n    }\r\n\r\n    function dragenter(e) {\r\n        e.preventDefault()\r\n    }\r\n\r\n\r\n    const likemojiView = (likemoji) => {\r\n        let likemojiViewHTML = html`<div\r\n            class=\"likemojis containerLikemojis ui-draggable ui-draggable-handle\"\r\n            id=\"${likemoji.id}\"\r\n            data-toggle=\"modal\"\r\n            data-target=\"#editLikemojisModal\"\r\n            draggable=\"true\"\r\n            ondragstart=\"${dragMoji}\"\r\n        >\r\n            <img\r\n                src=\"${likemoji.attributes.x3.url()}\"\r\n                class=\"likemojiImages grow\"\r\n            />\r\n            <div class=\"likemojiNames\">${likemoji.attributes.names.en}</div>\r\n        </div>`;\r\n\r\n        //console.log(likemojiViewHTML);\r\n        return likemojiViewHTML;\r\n    };\r\n\r\n    let likemojisListViewHTML = html`<div id=\"likemojisEditor\" class=\"editorWindow\" style=\"display: block;\">\r\n        <h3>Edit Likemojis</h3>\r\n        <hr/>\r\n        <div\r\n            id=\"likemojisContainer\"\r\n            class=\"scroll likemojisContainer-area dynamicAreaOverflow ui-droppable\"\r\n            ondragenter=\"${dragenter}\"\r\n            ondragover=\"${dragover}\"\r\n            ondrop=\"${handleDrop}\"\r\n        >\r\n            ${Channel.likemojis.map(moji => likemojiView(moji))}\r\n        </div>\r\n        <div class=\"selectDiv text-center\" data-toggle=\"modal\" data-target=\"#addLikemojisModal\">\r\n\t\t\t<button type=\"button\"  id=\"addLikemojisModalButton\" class=\"btn btn-default addLikemojis containerLikemojis\"><i style=\"font-size: 1.3em; color: white; margin-top: 4px;\" class=\"far fa-plus-square grow\"></i> Add Likemojis</button>\r\n        </div>\r\n    </div>`;\r\n\r\n    return likemojisListViewHTML;\r\n}\r\n\r\nexport default likemojisListView;","const {render, html, svg} = lighterhtml;\r\n\r\nfunction loginForm() {\r\n    let form = html`<h2>Login to your account</h2>\r\n    <form id=\"loginForm\" class=\"form\">\r\n        <div class=\"form-group\" id=\"emaildiv\">\r\n            <label for=\"emailSignup\">email</label>\r\n            <input type=\"email\" class=\"form-control\" id=\"loginEmail\" placeholder=\"enter your email here\">\r\n        </div>\r\n        <div class=\"form-group\" id=\"passworddiv\">\r\n            <label for=\"passwordSignup\">password</label>\r\n            <input type=\"password\" class=\"form-control\" id=\"loginPassword\" placeholder=\"enter your password here\"></div>\r\n        <button id=\"loginUser\" type=\"button\" class=\"btn btn-default\">\r\n            Login\r\n        </button>\r\n    </form>`;\r\n    return form;\r\n}\r\n\r\nexport default loginForm;","//import {render, html} from '//unpkg.com/lighterhtml?module';\r\nconst {render, html, svg} = lighterhtml;\r\n\r\n/* Main structure of the phone panel\r\n|phone\r\n|-category\r\n|--header\r\n|--callout\r\n|--likemojis\r\n|---likemoji list\r\n|---other categories\r\n|-navbar\r\n*/\r\n\r\n// phone function returns all the HTML for displaying the phone widget with the\r\n// data for an org set to be selected for the given \"category\" parameter\r\n// category is a Group object from Parse\r\nconst phone = async (Channel, selectedCategoryID) =>  {\r\n    if (!selectedCategoryID) {\r\n        selectedCategoryID = Channel.main\r\n    }\r\n    return /*await*/ phoneView(Channel, selectedCategoryID);\r\n}\r\n\r\n\r\n//const phoneView = (category, categories, categoryLikemojis) => {\r\n//const phoneView = (props) => {\r\nconst phoneView = (Channel) => {\r\n    console.info('rendering phoneView');\r\n    let orgID = Channel.channelID; //category.attributes.organizationID;\r\n    let panel2 = document.getElementById(\"panel2\");\r\n    let category = Channel.selectedCategory || Channel.mainCategory;\r\n    console.info(`selected category id: ${category.id}`);\r\n    const likemojisView = (likemojis) => {\r\n        let mainPageClass = 'likemojiGroupCollection-area';\r\n        if(category.attributes.main == 1) {\r\n            mainPageClass = mainPageClass + ' mainpageLikemojis';\r\n        }\r\n        let mojiHtml = html`<div id=\"likemojiGroupCollection\"\r\n                class=\"${mainPageClass}\">\r\n                  ${likemojis\r\n                    ? likemojis.map(moji => likemojiView(moji))\r\n                    : html`<h4 id=\"dragLikemojisPrompt\" class=\"dragLikemojisPrompt\" style=\"display:none\">Add Likemojis Here!</h4>`}\r\n            </div>`;\r\n\r\n        return mojiHtml;\r\n    }\r\n\r\n    let phoneHTML =\r\n    html`<div id='phone-view' class=\"col-lg-4 channelEdit\">\r\n        <div class=\"phone\" id=\"phoneView\">\r\n            <img class=\"phone\" src=\"assets/iPhone_7_front_frame sized.png\" />\r\n            <div id=\"phoneDisplay\" class=\"phoneDisplay-area\">\r\n                <div id=\"buildHeader\" class=\"header text-white\">\r\n                    <img id=\"docHeaderImage\" class=\"header\"\r\n                        src=\"${category.attributes.newHeader.url()}\" />\r\n                </div>\r\n                <div id=\"callout\" class=\"callout channelText\">\r\n                    ${category.attributes.callOuts.en}\r\n                </div>\r\n                <div class=\"phoneDisplayDynamicArea scroll dynamicAreaOverflow\"\r\n                    ondragenter=\"${dragenter}\"\r\n                    ondragover=\"${dragover}\"\r\n                    ondrop=\"${handleDrop}\"\r\n                >\r\n                    ${likemojisView(Channel.catLikemojis(category))}\r\n                    ${category.attributes.main == 1 ?\r\n                            categoriesSubView(Channel.categories)\r\n                            : html`<span></span>`\r\n                    }\r\n                </div>\r\n                ${phoneNavBarView(Channel)}\r\n            </div>\r\n        </div>\r\n    </div>`;\r\n    function handleDrop(e) {\r\n        e.preventDefault();\r\n        // find object dropped..get the id\r\n        //alert('droped moji with id: ' + e.dataTransfer.getData('Text'));\r\n        // storing data in drag event as \"ID,add\" or \"ID,remove\"\r\n        let dropEvent = e.dataTransfer.getData('Text').split(',');\r\n        if (dropEvent[1] === 'add') {\r\n            // add it\r\n            Channel.addCategoryLikemoji(category, dropEvent[0])\r\n            .then (\r\n                render(panel2, function () { return phoneView(Channel)})\r\n            )\r\n        }\r\n    }\r\n\r\n    function dragover(e) {\r\n        e.preventDefault()\r\n    }\r\n\r\n    function dragenter(e) {\r\n        e.preventDefault()\r\n    }\r\n\r\n    console.log(phoneHTML);\r\n    //let phoneView = html`<div id='phone-view' class=\"col-lg-4 channelEdit\">${phoneHTML}</div>`;\r\n    return phoneHTML;\r\n}\r\n\r\nconst phoneNavBarView =  (Channel) => {\r\n    function homeClick () { phoneHome(Channel)}\r\n\r\n    async function phoneHome(Channel) {\r\n        Channel.selectedCategory = Channel.mainCategory;\r\n        //let category = getMainCategory(categories);\r\n        //let categoryLikemojis = await getCategoryLikemojis(category);\r\n        //TODO decide to render our route here\r\n        //TODO can we just refer to this views parent (<div id=\"phoneView\">.parent)?\r\n        let panel2 = document.getElementById(\"panel2\");\r\n        let panel3 = document.getElementById(\"panel3\");\r\n\r\n        //panel2.innerHTML = '';\r\n        //render(panel2, function () { return phoneView(Channel)});\r\n        let route = \"/channel/\" + channelID + \"/view\";\r\n        //page(route);\r\n        page.redirect(route);\r\n    }\r\n    let channelID = Channel.channelID;\r\n    let navHTML = html`<div\r\n    id=\"navBar\"\r\n    class=\"navBar\"\r\n    style=\"background-color: rgb(24, 49, 103);\"\r\n    >\r\n        <div id=\"homeNavButton\"\r\n            class=\"navIcons\"\r\n            style=\"display:inline\">\r\n            <i\r\n                style=\"font-size: 1.3em; color: rgb(52, 255, 86);\"\r\n                class=\"fas fa-home activeNavIcon\"\r\n                onclick=\"${homeClick}\"\r\n                ></i>\r\n        </div>\r\n        <div id=\"inboxNavButton\" class=\"navIcons\" style=\"display:inline\">\r\n            <i\r\n                style=\"font-size: 1.3em; color: white;\"\r\n                class=\"far fa-envelope\"\r\n            ></i>\r\n        </div>\r\n        <div id=\"profileNavButton\" class=\"navIcons\" style=\"display:inline\">\r\n            <i style=\"font-size: 1.3em; color: white;\" class=\"fas fa-user\"></i>\r\n        </div>\r\n    </div>`;\r\n    return navHTML;\r\n}\r\n\r\n  const likemojiView = (likemoji) => {\r\n\r\n    function dragMoji(e) {\r\n        e.dataTransfer.setData('Text', e.currentTarget.id + ',remove');\r\n    }\r\n\r\n    let likemojiViewHTML = html`<div\r\n        class=\"containerLikemojis likemojis ui-draggable ui-draggable-handle\"\r\n        draggable=\"true\"\r\n        id=\"${likemoji.id}\"\r\n        draggable=\"true\"\r\n        ondragstart=\"${dragMoji}\"\r\n    >\r\n        <img\r\n            src=\"${likemoji.attributes.x3.url()}\"\r\n            class=\"likemojiImages\"/>\r\n        <div\r\n            class=\"likemojiNames channelText\"\r\n            style=\"color: rgb(52, 255, 86);\">\r\n            ${likemoji.attributes.names.en}\r\n        </div>\r\n    </div>`;\r\n\r\n    //console.log(likemojiViewHTML);\r\n    return likemojiViewHTML;\r\n};\r\n\r\n\r\nconst categoryView = (category, skipMain) => {\r\n    let orgID = category.attributes.organizationID;\r\n    /* simple pattern for click handlers\r\n    define a function that takes (e) as parameter\r\n    --- function myClicker(e) {\r\n    inside function find the target and the id data attribute\r\n    --- let targetID = e.currentTarget.dataset.i;\r\n    --- execute something\r\n    then define onclick and data-i attribute\r\n    --- <a data-i=${i.id} onclick=\"${myClicker}\">\r\n    */\r\n    function selectCategory(e) {\r\n        let targetID = e.currentTarget.dataset.i;\r\n        page.redirect(`/channel/${orgID}/view/${targetID}`);\r\n        //Channel.selectedCategoryID = targetID;\r\n        //let panel2 = document.getElementById(\"panel2\");\r\n        //render(panel2, function () { return phoneView(Channel)});\r\n    }\r\n\r\n    if (skipMain) {\r\n        if (category.attributes.main ==1) return html`<span></span>`;\r\n    }\r\n    let imgSrc = category.attributes.newCategoryImage ?\r\n                category.attributes.newCategoryImage.url()\r\n                : category.attributes.newHeader.url();\r\n    let catName = category.attributes.name;\r\n    let catID = category.id;\r\n\r\n    let categoryViewHTML = html`<div class=\"category\"\r\n        type=\"button\"\r\n        id=\"${catID}\"\r\n        data-i=\"${catID}\"\r\n        onclick=\"${selectCategory}\">\r\n        <img\r\n            src=\"${imgSrc}\"\r\n            width=\"100%\"\r\n            height=\"auto\"/>\r\n        <p class=\"categorytxt\" style=\"color: rgb(255, 255, 255);\">\r\n            ${catName}\r\n        </p>\r\n    </div>`;\r\n\r\n    //console.log(categoryViewHTML);\r\n    return categoryViewHTML;\r\n}\r\n\r\nconst categoriesSubView = (cats) => {\r\n    console.log('composing categoriesSubView');\r\n    return html`<div id=\"categories\" class=\"categories\">\r\n            ${cats.map(cat => {\r\n                    if (cat.attributes.disable !== 1) {\r\n                        return categoryView(cat, true)\r\n                    }\r\n                    else {return html`<span></span>`}\r\n                })\r\n            }\r\n      </div>`;\r\n}\r\n\r\nconst getCategoryLikemojis = async (category) => {\r\n    let IDs = category.attributes.likemojis;\r\n    let likemojis = [];\r\n    if (IDs.length > 0) {\r\n        likemojis = await getLikemojisByID(IDs);\r\n    }\r\n    return likemojis;\r\n}\r\n\r\n// returns likemojis sorted by name from a list of ids useful for getting the\r\n// mojis of the given category (group)\r\nasync function getLikemojisByID(likemojiIDs) {\r\n    const query = new Parse.Query(\"Likemoji\");\r\n    query.containedIn(\"objectId\", likemojiIDs);\r\n    query.ascending(\"name\");\r\n    try {\r\n        return await query.find();\r\n    } catch (err) {\r\n        // TypeError: failed to fetch\r\n        alert(err);\r\n    }\r\n}\r\n\r\nexport {phone, phoneView, getCategoryLikemojis};","const {render, html, svg} = lighterhtml;\r\nfunction signUpForm() {\r\n    let form = html`<div>\r\n    <form id=\"signUpForm\" class=\"form\">\r\n\t\t<h2>Create Your Account</h2>\r\n\t\t<div class=\"form-group\" id=\"emaildiv\">\r\n\t\t\t<label for=\"emailSignup\">email</label>\r\n\t\t\t<input type=\"email\" class=\"form-control\" id=\"inputEmail\" placeholder=\"enter your email here\">\r\n\t\t</div>\r\n\t\t<div class=\"form-group\" id=\"passworddiv\">\r\n\t\t\t<label for=\"passwordSignup\">password</label>\r\n\t\t\t<input type=\"password\" class=\"form-control\" id=\"inputPassword\" placeholder=\"create your password here\">\r\n\t\t</div>\r\n\t\t<div class=\"form-group\" id=\"organizationdiv\">\r\n\t\t\t\t<label for=\"organizationSignup\">Organization Name</label>\r\n                <input type=\"text\"\r\n                    class=\"form-control\"\r\n                    id=\"inputOrganization\"\r\n                    placeholder=\"organization name\"\r\n                >\r\n\t\t</div>\r\n        <button id=\"signUpUser2\" type=\"button\" class=\"btn btn-default\">Start</button>\r\n    </form>\r\n    </div>`;\r\n\r\n    return form;\r\n}\r\nexport default signUpForm;","const {render, html, svg} = lighterhtml;\r\n\r\nfunction styleEditorView(Channel) {\r\n\tconsole.info('rendering stlyeEditorView');\r\n    let style = Channel.channelStyle;\r\n    let jscolor = `jscolor {position:'right',\r\n    borderColor:'#FFF #666 #666 #FFF',\r\n    insetColor:'#666 #FFF #FFF #666',\r\n    backgroundColor:'#CCC'}`;\r\n\r\n    let editorView = html `<div id=\"colorThemeEditor\" class=\"editorWindow\">\r\n            <div id=\"themeContainer\">\r\n                <h4 style=\"display:inline\">Edit Theme (Color / Font):</h4>\r\n                <br>\r\n                <br>\r\n                <div class=\"form-group\">\r\n                    <input id=\"backgroundColor\" class=\"${jscolor}\"\r\n                        data-attr=\"generalColor\"\r\n                        value=\"${style.get(\"generalColor\")}\"\r\n                        onchange=${setTemp}\r\n                    >\r\n                    <label for=\"backgroundColor\">&nbsp;-&nbsp;Background</label>\r\n                </div>\r\n                <div class=\"form-group\">\r\n                    <input id=\"textColor\" class=\"${jscolor}\"\r\n                        data-attr=\"generalTextColor\"\r\n                        value=\"${style.get(\"generalTextColor\")}\"\r\n                        onchange=${setTemp}\r\n                        >\r\n                    <label for=\"textColor\"> - Text</label>\r\n                </div>\r\n                <div class=\"form-group\">\r\n                    <input id=\"catTextColor\" class=\"${jscolor}\"\r\n                        data-attr=\"categoryTextColor\"\r\n                        value=\"${style.get(\"categoryTextColor\")}\"\r\n                        onchange=${setTemp}\r\n                    >\r\n                    <label for=\"catTextColor\"> - Category Label Text</label>\r\n                </div>\r\n                <div class=\"form-group\">\r\n                    <input id=\"navColor\" class=\"${jscolor}\"\r\n                        data-attr=\"tabBar starColor navButtonColor\"\r\n                        value=\"${style.get(\"tabBar\")}\"\r\n                        onchange=${setTemp}\r\n                    >\r\n                    <label for=\"navColor\"> - NavBar / Buttons / Stars</label>\r\n                </div>\r\n                <div class=\"form-group\">\r\n                    <input id=\"activeNav\" class=\"${jscolor}\"\r\n                        data-attr=\"tabBarSelected\"\r\n                        value=\"${style.get(\"tabBarSelected\")}\"\r\n                        onchange=${setTemp}\r\n                    >\r\n                    <label for=\"activeNav\"> - Active Nav Button</label>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div id=\"themeSaveButtons\" class=\"btn-group themeSaveButtons\" role=\"group\" aria-label=\"...\">\r\n            <button id=\"editorThemeCancel\" class=\"btn btn-editorThemeSave\" onclick=\"${closeStyleEditor}\">\r\n                <label for=\"themeCancel\">\r\n                    <i style=\"font-size: 1.3em; color: white;\" class=\"fas fa-ban\"></i>\r\n                    <h5 style=\"display:inline\">cancel</h5>\r\n                </label>\r\n            </button>\r\n            <button id=\"editorThemeSave\"\r\n                class=\"btn btn-editorThemeSave active\"\r\n                onclick=\"${saveStyle}\"\r\n            >\r\n                <label>\r\n                        <i style=\"font-size: 1.3em; color: white;\" class=\"fas fa-save\"></i>\r\n                        <h5 style=\"display:inline\">save</h5>\r\n                </label>\r\n            </button>\r\n        </div>\r\n        <script>jscolor.installByClassName(\"jscolor\");</script>\r\n        `;\r\n\r\n    function setTemp(e) {\r\n        let attribs = e.currentTarget.dataset.attr.split(' ');\r\n        let val = '#' + e.currentTarget.value;\r\n        console.log(`set attribute ${attribs} to value ${val}`);\r\n        for (var i = 0; i < attribs.length; i++) {\r\n            style.set(attribs[i], val);\r\n        }\r\n        Channel.updateViews();\r\n    }\r\n\r\n    function saveStyle() {\r\n        //TODO what are these here for???\r\n        style.set(\"fontCategorySize\", \"Large\");\r\n        style.set(\"font\", \"Avenir-Next\");\r\n        style.set(\"fontSize\", \"16\");\r\n\r\n        style.save().then(\r\n            style => {\r\n                // Execute any logic that should take place after the object is saved.\r\n                // alert('Saved objectId: ' + style.id);\r\n                Channel.updateViews();\r\n            }, error => {\r\n                // Execute any logic that should take place if the save fails. error is a\r\n                // Parse.Error with an error code and message.\r\n                alert(\"Failed to create new object, with error code: \" + error.message);\r\n            });\r\n    }\r\n\r\n    function closeStyleEditor (e) {\r\n        e.preventDefault();\r\n        //refresh Channel data with style from database\r\n        let close = !style.dirty() || confirm('Discard unsaved changes');\r\n        if (close) {\r\n            Channel.resetStyle()\r\n            .then ( () => {\r\n                console.info(`reverted stlyle and now tabbar has a value of ${style.get(\"tabBar\")}`);\r\n                Channel.updateViews();\r\n                }\r\n            );\r\n\r\n            // TODO is this the best way to revert back?\r\n            togglePanelWithin('panel-editor', 'panel3');\r\n        }\r\n    }\r\n\r\n    return editorView;\r\n}\r\n\r\nfunction togglePanelWithin(panelName, parentName) {\r\n    let panel, parent;\r\n    panel = document.getElementById(panelName);\r\n    if (panel) {\r\n        parent = document.getElementById(parentName);\r\n        if (parent){\r\n            for (var i = 0; i < parent.children.length; i++) {\r\n                parent.children[i].classList.add('hidden');\r\n              }\r\n            panel.classList.remove('hidden');\r\n        }\r\n        else {\r\n            console.warn(`panel ${parentName} not found`);\r\n        }\r\n    }\r\n    else {\r\n        console.warn(`panel ${panelName} not found`);\r\n    }\r\n}\r\n\r\nexport default styleEditorView;\r\n\r\n//edit color styles edit background color\r\n/*\r\n$(\"#backgroundColor\")\r\n    .change(function () {\r\n        $(\"#phoneDisplay\").css(\"background-color\", \"#\" + $(\"#backgroundColor\").val());\r\n    });\r\n\r\n//edit navbar color\r\n\r\n$(\"#navColor\").change(function () {\r\n    $(\"#navBar\").css(\"background-color\", \"#\" + $(\"#navColor\").val());\r\n});\r\n\r\n//edit active navbutton color\r\n\r\n$(\"#activeNav\").change(function () {\r\n    $(\".activeNavIcon\").css(\"color\", \"#\" + $(\"#activeNav\").val());\r\n});\r\n\r\n//edit general text color\r\n\r\n$(\"#textColor\").change(function () {\r\n    $(\".channelText\").css(\"color\", \"#\" + $(\"#textColor\").val());\r\n});\r\n\r\n//edit category text color\r\n\r\n$(\"#catTextColor\").change(function () {\r\n    $(\".categorytxt\").css(\"color\", \"#\" + $(\"#catTextColor\").val());\r\n});\r\n*/"],"sourceRoot":""}